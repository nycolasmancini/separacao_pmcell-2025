var e=Object.defineProperty,t=Object.defineProperties,s=Object.getOwnPropertyDescriptors,r=Object.getOwnPropertyNames,a=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable,o=(t,s,r)=>s in t?e(t,s,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[s]=r,l=(e,t)=>{for(var s in t||(t={}))n.call(t,s)&&o(e,s,t[s]);if(a)for(var s of a(t))i.call(t,s)&&o(e,s,t[s]);return e},d=(e,r)=>t(e,s(r)),c=(e,t)=>{var s={};for(var r in e)n.call(e,r)&&t.indexOf(r)<0&&(s[r]=e[r]);if(null!=e&&a)for(var r of a(e))t.indexOf(r)<0&&i.call(e,r)&&(s[r]=e[r]);return s},m=(e,t,s)=>o(e,"symbol"!=typeof t?t+"":t,s),x=(e,t,s)=>new Promise((r,a)=>{var n=e=>{try{o(s.next(e))}catch(t){a(t)}},i=e=>{try{o(s.throw(e))}catch(t){a(t)}},o=e=>e.done?r(e.value):Promise.resolve(e.value).then(n,i);o((s=s.apply(e,t)).next())});import{j as u,m as h,A as g}from"./ui-Bw0PRKgF.js";import{a as p,r as b,u as j,b as v,N as f,B as y,c as N,d as w}from"./vendor-BXMoyY1S.js";import{c as k,a as C}from"./utils-DPXtZn4l.js";var _,S,O=(_={"assets/js/index-DPfHx169.js"(e){var t;!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const s of e)if("childList"===s.type)for(const e of s.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var s=p;function r(e,t){let s;try{s=e()}catch(r){return}return{getItem:e=>{var t;const r=e=>null===e?null:JSON.parse(e,void 0),a=null!=(t=s.getItem(e))?t:null;return a instanceof Promise?a.then(r):r(a)},setItem:(e,t)=>s.setItem(e,JSON.stringify(t,void 0)),removeItem:e=>s.removeItem(e)}}t=s.createRoot,s.hydrateRoot;const a=e=>t=>{try{const s=e(t);return s instanceof Promise?s:{then:e=>a(e)(s),catch(e){return this}}}catch(s){return{then(e){return this},catch:e=>a(e)(s)}}},n=(e,t)=>"getStorage"in t||"serialize"in t||"deserialize"in t?((e,t)=>(s,r,n)=>{let i=l({getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:e=>e,version:0,merge:(e,t)=>l(l({},t),e)},t),o=!1;const d=new Set,c=new Set;let m;try{m=i.getStorage()}catch(j){}if(!m)return e((...e)=>{s(...e)},r,n);const x=a(i.serialize),u=()=>{const e=i.partialize(l({},r()));let t;const s=x({state:e,version:i.version}).then(e=>m.setItem(i.name,e)).catch(e=>{t=e});if(t)throw t;return s},h=n.setState;n.setState=(e,t)=>{h(e,t),u()};const g=e((...e)=>{s(...e),u()},r,n);let p;const b=()=>{var e;if(!m)return;o=!1,d.forEach(e=>e(r()));const t=(null==(e=i.onRehydrateStorage)?void 0:e.call(i,r()))||void 0;return a(m.getItem.bind(m))(i.name).then(e=>{if(e)return i.deserialize(e)}).then(e=>{if(e){if("number"!=typeof e.version||e.version===i.version)return e.state;if(i.migrate)return i.migrate(e.state,e.version)}}).then(e=>{var t;return p=i.merge(e,null!=(t=r())?t:g),s(p,!0),u()}).then(()=>{null==t||t(p,void 0),o=!0,c.forEach(e=>e(p))}).catch(e=>{null==t||t(void 0,e)})};return n.persist={setOptions:e=>{i=l(l({},i),e),e.getStorage&&(m=e.getStorage())},clearStorage:()=>{null==m||m.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>b(),hasHydrated:()=>o,onHydrate:e=>(d.add(e),()=>{d.delete(e)}),onFinishHydration:e=>(c.add(e),()=>{c.delete(e)})},b(),p||g})(e,t):((e,t)=>(s,n,i)=>{let o=l({storage:r(()=>localStorage),partialize:e=>e,version:0,merge:(e,t)=>l(l({},t),e)},t),d=!1;const c=new Set,m=new Set;let x=o.storage;if(!x)return e((...e)=>{s(...e)},n,i);const u=()=>{const e=o.partialize(l({},n()));return x.setItem(o.name,{state:e,version:o.version})},h=i.setState;i.setState=(e,t)=>{h(e,t),u()};const g=e((...e)=>{s(...e),u()},n,i);let p;i.getInitialState=()=>g;const b=()=>{var e,t;if(!x)return;d=!1,c.forEach(e=>{var t;return e(null!=(t=n())?t:g)});const r=(null==(t=o.onRehydrateStorage)?void 0:t.call(o,null!=(e=n())?e:g))||void 0;return a(x.getItem.bind(x))(o.name).then(e=>{if(e){if("number"!=typeof e.version||e.version===o.version)return[!1,e.state];if(o.migrate)return[!0,o.migrate(e.state,e.version)]}return[!1,void 0]}).then(e=>{var t;const[r,a]=e;if(p=o.merge(a,null!=(t=n())?t:g),s(p,!0),r)return u()}).then(()=>{null==r||r(p,void 0),p=n(),d=!0,m.forEach(e=>e(p))}).catch(e=>{null==r||r(void 0,e)})};return i.persist={setOptions:e=>{o=l(l({},o),e),e.storage&&(x=e.storage)},clearStorage:()=>{null==x||x.removeItem(o.name)},getOptions:()=>o,rehydrate:()=>b(),hasHydrated:()=>d,onHydrate:e=>(c.add(e),()=>{c.delete(e)}),onFinishHydration:e=>(m.add(e),()=>{m.delete(e)})},o.skipHydration||b(),p||g})(e,t),i=k((o=n((t,s)=>({user:null,token:null,isAuthenticated:!1,isLoading:!1,error:null,orderAccessUser:null,currentOrderId:null,isOrderAuthenticated:!1,login:s=>x(e,null,function*(){var e,r,a,n,i,o,l;t({isLoading:!0,error:null});try{const e=yield C.post("http://localhost:8000/api/v1/auth/login",{pin:s}),{access_token:r,user:a}=e.data;return localStorage.setItem("auth_token",r),t({user:a,token:r,isAuthenticated:!0,isLoading:!1,error:null}),{success:!0}}catch(d){let s="Erro no login";return s="ECONNABORTED"===d.code||d.message.includes("timeout")?"Timeout - verifique sua conexão":"ERR_NETWORK"!==d.code&&d.response?401===(null==(e=d.response)?void 0:e.status)?"PIN incorreto":400===(null==(r=d.response)?void 0:r.status)?(null==(n=null==(a=d.response)?void 0:a.data)?void 0:n.detail)||"PIN inválido":(null==(i=d.response)?void 0:i.status)>=500?"Erro no servidor - tente novamente":(null==(l=null==(o=d.response)?void 0:o.data)?void 0:l.detail)||"Erro no login":"Erro de conexão - servidor não responde",t({user:null,token:null,isAuthenticated:!1,isLoading:!1,error:s}),{success:!1,error:s}}}),logout:()=>{localStorage.removeItem("auth_token"),t({user:null,token:null,isAuthenticated:!1,isLoading:!1,error:null})},clearError:()=>{t({error:null})},hasRole:e=>{const{user:t}=s();return(null==t?void 0:t.role)===e},isAdmin:()=>{const{user:e}=s();return"admin"===(null==e?void 0:e.role)},setOrderAccess:(e,s)=>{t({orderAccessUser:e,currentOrderId:s,isOrderAuthenticated:!0})},clearOrderAccess:()=>{t({orderAccessUser:null,currentOrderId:null,isOrderAuthenticated:!1})},hasOrderAccess:e=>{const{isOrderAuthenticated:t,currentOrderId:r}=s();return t&&r===e}}),{name:"auth-storage",storage:r(()=>localStorage),partialize:e=>({user:e.user,token:e.token,isAuthenticated:e.isAuthenticated,orderAccessUser:e.orderAccessUser,currentOrderId:e.currentOrderId,isOrderAuthenticated:e.isOrderAuthenticated})}),(e,t,s)=>o((...t)=>{e(...t)},t,s)));var o;function _({message:e,type:t="info",duration:s=4e3,onClose:r,className:a=""}){const[n,i]=b.useState(!0),[o,l]=b.useState(!1);b.useEffect(()=>{if(s>0){const e=setTimeout(()=>{d()},s);return()=>clearTimeout(e)}},[s]);const d=()=>{l(!0),setTimeout(()=>{i(!1),r&&r()},300)};return n?u.jsx("div",{className:`\n        transition-all duration-300 transform\n        ${o?"translate-x-full opacity-0":"translate-x-0 opacity-100"}\n        ${(()=>{const e="flex items-center p-4 rounded-lg shadow-lg border";switch(t){case"success":return`${e} bg-green-50 border-green-200 text-green-800`;case"error":return`${e} bg-red-50 border-red-200 text-red-800`;case"warning":return`${e} bg-yellow-50 border-yellow-200 text-yellow-800`;default:return`${e} bg-blue-50 border-blue-200 text-blue-800`}})()}\n        ${a}\n      `,children:u.jsxs("div",{className:"flex items-center space-x-3",children:[u.jsx("div",{className:"flex-shrink-0",children:(()=>{switch(t){case"success":return u.jsx("svg",{className:"w-5 h-5 text-green-400",fill:"currentColor",viewBox:"0 0 20 20",children:u.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})});case"error":return u.jsx("svg",{className:"w-5 h-5 text-red-400",fill:"currentColor",viewBox:"0 0 20 20",children:u.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})});case"warning":return u.jsx("svg",{className:"w-5 h-5 text-yellow-400",fill:"currentColor",viewBox:"0 0 20 20",children:u.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})});default:return u.jsx("svg",{className:"w-5 h-5 text-blue-400",fill:"currentColor",viewBox:"0 0 20 20",children:u.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})})}})()}),u.jsx("div",{className:"flex-1 text-sm font-medium",children:e}),u.jsx("button",{onClick:d,className:"flex-shrink-0 ml-4 p-1 rounded-md hover:bg-black hover:bg-opacity-10 transition-colors",children:u.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:u.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})]})}):null}const S=b.createContext(),O=()=>{const e=b.useContext(S);if(!e)throw new Error("useToast deve ser usado dentro de um ToastProvider");return e};function E({children:e}){const[t,s]=b.useState([]),r=b.useCallback((e,t="info",r=4e3)=>{const a=Date.now()+Math.random(),n={id:a,message:e,type:t,duration:r};return s(e=>[...e,n]),a},[]),a=b.useCallback(e=>{s(t=>t.filter(t=>t.id!==e))},[]),n=b.useCallback((e,t)=>r(e,"success",t),[r]),i=b.useCallback((e,t)=>r(e,"error",t),[r]),o=b.useCallback((e,t)=>r(e,"warning",t),[r]),l=b.useCallback((e,t)=>r(e,"info",t),[r]),d={addToast:r,removeToast:a,showSuccess:n,showError:i,showWarning:o,showInfo:l};return u.jsxs(S.Provider,{value:d,children:[e,u.jsx(L,{toasts:t,onRemove:a})]})}function L({toasts:e,onRemove:t}){return u.jsx("div",{className:"fixed top-4 right-4 z-50 space-y-2",children:e.map(e=>u.jsx(_,{message:e.message,type:e.type,duration:e.duration,onClose:()=>t(e.id)},e.id))})}function I(e,t){var s=e,{title:r,titleId:a}=s,n=c(s,["title","titleId"]);return b.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":a},n),r?b.createElement("title",{id:a},r):null,b.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18"}))}const $=b.forwardRef(I);function P(e,t){var s=e,{title:r,titleId:a}=s,n=c(s,["title","titleId"]);return b.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":a},n),r?b.createElement("title",{id:a},r):null,b.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0 3.181 3.183a8.25 8.25 0 0 0 13.803-3.7M4.031 9.865a8.25 8.25 0 0 1 13.803-3.7l3.181 3.182m0-4.991v4.99"}))}const M=b.forwardRef(P);function A(e,t){var s=e,{title:r,titleId:a}=s,n=c(s,["title","titleId"]);return b.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":a},n),r?b.createElement("title",{id:a},r):null,b.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const T=b.forwardRef(A);function B(e,t){var s=e,{title:r,titleId:a}=s,n=c(s,["title","titleId"]);return b.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":a},n),r?b.createElement("title",{id:a},r):null,b.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v6h4.5m4.5 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const z=b.forwardRef(B);function R(e,t){var s=e,{title:r,titleId:a}=s,n=c(s,["title","titleId"]);return b.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":a},n),r?b.createElement("title",{id:a},r):null,b.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v12m-3-2.818.879.659c1.171.879 3.07.879 4.242 0 1.172-.879 1.172-2.303 0-3.182C13.536 12.219 12.768 12 12 12c-.725 0-1.45-.22-2.003-.659-1.106-.879-1.106-2.303 0-3.182s2.9-.879 4.006 0l.415.33M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const U=b.forwardRef(R);function D(e,t){var s=e,{title:r,titleId:a}=s,n=c(s,["title","titleId"]);return b.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":a},n),r?b.createElement("title",{id:a},r):null,b.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6.75a.75.75 0 1 1 0-1.5.75.75 0 0 1 0 1.5ZM12 12.75a.75.75 0 1 1 0-1.5.75.75 0 0 1 0 1.5ZM12 18.75a.75.75 0 1 1 0-1.5.75.75 0 0 1 0 1.5Z"}))}const F=b.forwardRef(D);function W(e,t){var s=e,{title:r,titleId:a}=s,n=c(s,["title","titleId"]);return b.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":a},n),r?b.createElement("title",{id:a},r):null,b.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126ZM12 15.75h.007v.008H12v-.008Z"}))}const V=b.forwardRef(W);function H(e,t){var s=e,{title:r,titleId:a}=s,n=c(s,["title","titleId"]);return b.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":a},n),r?b.createElement("title",{id:a},r):null,b.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 3h1.386c.51 0 .955.343 1.087.835l.383 1.437M7.5 14.25a3 3 0 0 0-3 3h15.75m-12.75-3h11.218c1.121-2.3 2.1-4.684 2.924-7.138a60.114 60.114 0 0 0-16.536-1.84M7.5 14.25 5.106 5.272M6 20.25a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0Zm12.75 0a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0Z"}))}const q=b.forwardRef(H);function J(e,t){var s=e,{title:r,titleId:a}=s,n=c(s,["title","titleId"]);return b.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":a},n),r?b.createElement("title",{id:a},r):null,b.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 6a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0ZM4.501 20.118a7.5 7.5 0 0 1 14.998 0A17.933 17.933 0 0 1 12 21.75c-2.676 0-5.216-.584-7.499-1.632Z"}))}const Z=b.forwardRef(J);function G(e,t){var s=e,{title:r,titleId:a}=s,n=c(s,["title","titleId"]);return b.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":a},n),r?b.createElement("title",{id:a},r):null,b.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m9.75 9.75 4.5 4.5m0-4.5-4.5 4.5M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const Q=b.forwardRef(G);function K(e,t){var s=e,{title:r,titleId:a}=s,n=c(s,["title","titleId"]);return b.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":a},n),r?b.createElement("title",{id:a},r):null,b.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18 18 6M6 6l12 12"}))}const Y=b.forwardRef(K);function X({size:e="md",variant:t="default",className:s=""}){const r={sm:{container:"h-8",icon:"w-8 h-8",text:"text-lg",subtitle:"text-xs"},md:{container:"h-12",icon:"w-12 h-12",text:"text-2xl",subtitle:"text-sm"},lg:{container:"h-16",icon:"w-16 h-16",text:"text-3xl",subtitle:"text-base"}}[e],a={default:{iconBg:"bg-gradient-primary",iconText:"text-white",mainText:"text-gray-900",subtitle:"text-gray-600"},white:{iconBg:"bg-white",iconText:"text-primary-500",mainText:"text-white",subtitle:"text-gray-200"},minimal:{iconBg:"bg-primary-500",iconText:"text-white",mainText:"text-gray-900",subtitle:"text-gray-600"}}[t];return u.jsxs(h.div,{className:`flex items-center space-x-3 ${r.container} ${s}`,initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{duration:.3,ease:"easeOut"},children:[u.jsxs(h.div,{className:`\n          ${r.icon} \n          ${a.iconBg} \n          rounded-xl \n          flex items-center justify-center \n          shadow-lg\n          relative overflow-hidden\n        `,whileHover:{scale:1.05},transition:{duration:.2},children:[u.jsxs("div",{className:"absolute inset-0 opacity-20",children:[u.jsx("div",{className:"absolute top-1 right-1 w-2 h-2 bg-white rounded-full"}),u.jsx("div",{className:"absolute bottom-1 left-1 w-1 h-1 bg-white rounded-full"})]}),u.jsx(h.span,{className:`${a.iconText} font-bold ${r.text} relative z-10`,initial:{rotateY:-90},animate:{rotateY:0},transition:{delay:.2,duration:.5},children:"P"})]}),u.jsxs("div",{className:"flex flex-col justify-center",children:[u.jsx(h.h1,{className:`${a.mainText} ${r.text} font-bold leading-tight`,initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.3,duration:.4},children:"PMCELL"}),u.jsx(h.p,{className:`${a.subtitle} ${r.subtitle} font-medium leading-tight`,initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.4,duration:.4},children:"Separação de Pedidos"})]})]})}class ee extends b.Component{constructor(e){super(e),m(this,"handleReload",()=>{window.location.reload()}),m(this,"handleReset",()=>{this.setState({hasError:!1,error:null,errorInfo:null})}),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(e){return{hasError:!0}}componentDidCatch(e,t){this.setState({error:e,errorInfo:t})}render(){if(this.state.hasError){const{fallback:e,showDetails:t=!1}=this.props;return e?u.jsx(e,{error:this.state.error,errorInfo:this.state.errorInfo,onReset:this.handleReset,onReload:this.handleReload}):u.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center px-4",children:u.jsx(h.div,{className:"max-w-md w-full",initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{duration:.3},children:u.jsxs("div",{className:"card card-hover p-8 text-center",children:[u.jsx("div",{className:"flex justify-center mb-6",children:u.jsx(X,{size:"md"})}),u.jsx(h.div,{className:"flex justify-center mb-6",initial:{rotate:-10},animate:{rotate:0},transition:{delay:.2,duration:.3},children:u.jsx("div",{className:"p-4 bg-red-100 rounded-full",children:u.jsx(V,{className:"w-12 h-12 text-red-600"})})}),u.jsxs(h.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3,duration:.4},children:[u.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Ops! Algo deu errado"}),u.jsx("p",{className:"text-gray-600 mb-6",children:"Ocorreu um erro inesperado. Nossa equipe foi notificada e está trabalhando para resolver."})]}),u.jsxs(h.div,{className:"space-y-3",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4,duration:.4},children:[u.jsxs("button",{onClick:this.handleReset,className:"btn-primary w-full",children:[u.jsx(M,{className:"w-5 h-5 mr-2"}),"Tentar Novamente"]}),u.jsx("button",{onClick:this.handleReload,className:"btn-secondary w-full",children:"Recarregar Página"})]}),t&&this.state.error&&u.jsxs(h.details,{className:"mt-6 text-left",initial:{opacity:0},animate:{opacity:1},transition:{delay:.5,duration:.3},children:[u.jsx("summary",{className:"cursor-pointer text-sm text-gray-500 hover:text-gray-700 transition-colors",children:"Detalhes técnicos"}),u.jsxs("div",{className:"mt-2 p-4 bg-gray-100 rounded-lg text-xs font-mono overflow-auto max-h-40 scrollbar-thin",children:[u.jsx("div",{className:"text-red-600 font-semibold mb-2",children:this.state.error.toString()}),u.jsx("div",{className:"text-gray-700 whitespace-pre-wrap",children:this.state.errorInfo.componentStack})]})]}),u.jsx(h.div,{className:"mt-6 pt-6 border-t border-gray-200",initial:{opacity:0},animate:{opacity:1},transition:{delay:.6,duration:.3},children:u.jsx("p",{className:"text-xs text-gray-500",children:"Se o problema persistir, entre em contato com o suporte técnico."})})]})})})}return this.props.children}}function te({children:e}){return u.jsx(ee,{children:e})}function se({children:e,fallback:t}){return u.jsx(ee,{fallback:t,children:e})}function re({size:e="md",color:t="primary",className:s=""}){return u.jsx(h.div,{className:`${{xs:"w-3 h-3",sm:"w-4 h-4",md:"w-6 h-6",lg:"w-8 h-8",xl:"w-12 h-12"}[e]} ${{primary:"text-primary-500",white:"text-white",gray:"text-gray-500",current:"text-current"}[t]} ${s}`,animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},children:u.jsxs("svg",{className:"w-full h-full",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 2v4m0 12v4M4.93 4.93l2.83 2.83m8.49 8.49l2.83 2.83M2 12h4m12 0h4M4.93 19.07l2.83-2.83m8.49-8.49l2.83-2.83",className:"opacity-25"}),u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 2v4",className:"opacity-75"})]})})}function ae({size:e="sm",className:t=""}){return u.jsx(re,{size:e,color:"current",className:`animate-spin ${t}`})}const ne={xs:475,sm:640,md:768,tablet:768,lg:1024,"tablet-lg":1024,xl:1280,"2xl":1536};function ie(){const[e,t]=b.useState({width:"undefined"!=typeof window?window.innerWidth:0,height:"undefined"!=typeof window?window.innerHeight:0}),[s,r]=b.useState("portrait");b.useEffect(()=>{function e(){const e=window.innerWidth,s=window.innerHeight;t({width:e,height:s}),r(e>s?"landscape":"portrait")}return window.addEventListener("resize",e),window.addEventListener("orientationchange",()=>{setTimeout(e,100)}),e(),()=>{window.removeEventListener("resize",e),window.removeEventListener("orientationchange",e)}},[]);const a=e.width<ne.md,n=e.width>=ne.tablet&&e.width<ne["tablet-lg"],i=e.width>=ne.tablet,o=e.width>=ne["tablet-lg"],d=e.width>=ne.xl,[c,m]=b.useState(!1);b.useEffect(()=>{m("ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0)},[]);const x=/iPad|Macintosh/i.test(navigator.userAgent)&&c,u=/Android/i.test(navigator.userAgent)&&!/Mobile/i.test(navigator.userAgent),h=x||u||n&&c,g=(e={})=>{const t=l(l({},{mobile:1,tablet:2,desktop:3,large:4}),e);return a?t.mobile:n?t.tablet:o&&!d?t.desktop:t.large};return{windowSize:e,orientation:s,isMobile:a,isTablet:n,isTabletUp:i,isActualTablet:h,isDesktop:o,isLargeScreen:d,isTouchDevice:c,isIPad:x,isAndroidTablet:u,isAbove:t=>{const s=ne[t];return e.width>=s},isBelow:t=>{const s=ne[t];return e.width<s},isBetween:(t,s)=>{const r=ne[t],a=ne[s];return e.width>=r&&e.width<a},getGridCols:g,getGridClass:(e={})=>`grid-cols-${g(e)}`,getComponentConfig:e=>{const t={sidebar:{mobile:{position:"overlay",width:"80%"},tablet:{position:"overlay",width:"320px"},desktop:{position:"fixed",width:"256px"}},orderCard:{mobile:{size:"full",padding:"4"},tablet:{size:"auto",padding:"6"},desktop:{size:"auto",padding:"6"}},pagination:{mobile:{showLabels:!1,itemsPerPage:10},tablet:{showLabels:!0,itemsPerPage:15},desktop:{showLabels:!0,itemsPerPage:20}},modal:{mobile:{fullScreen:!0,padding:"4"},tablet:{fullScreen:!1,padding:"6",maxWidth:"2xl"},desktop:{fullScreen:!1,padding:"8",maxWidth:"4xl"}}}[e]||{};return a?t.mobile||{}:n||h?t.tablet||{}:t.desktop||{}},getResponsiveClasses:(e={})=>{const t=l(l({},{mobile:"",tablet:"",desktop:""}),e);let s=t.mobile||"";return i&&t.tablet&&(s+=` tablet:${t.tablet}`),o&&t.desktop&&(s+=` lg:${t.desktop}`),s.trim()},breakpoints:ne}}const oe={initial:{},animate:{transition:{staggerChildren:.1,delayChildren:.1}},exit:{transition:{staggerChildren:.05,staggerDirection:-1}}};l({},{y:-5,scale:1.02,transition:{duration:.2,ease:"easeOut"}});const le={statsCard:{initial:{opacity:0,y:20},animate:{opacity:1,y:0,transition:{duration:.4,ease:"easeOut"}},hover:{y:-2,transition:{duration:.2}}}},de={container:{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1,transition:{duration:.4,ease:"easeOut"}}},logo:{initial:{opacity:0,y:-30},animate:{opacity:1,y:0,transition:{duration:.5,ease:"easeOut",delay:.2}}},keypad:{initial:{opacity:0,y:20},animate:{opacity:1,y:0,transition:{duration:.4,ease:"easeOut",delay:.4}}},keyButton:{initial:{scale:1},hover:{scale:1.05,backgroundColor:"#f97316",color:"#ffffff",transition:{duration:.15}},tap:{scale:.95,transition:{duration:.1}}}};function ce(){const[e,t]=b.useState(""),[s,r]=b.useState(!1),{login:a,isLoading:n,error:o,clearError:l}=i(),{isTabletUp:d,isTouchDevice:c}=ie();b.useEffect(()=>{if(o){r(!0),t("");const e=setTimeout(()=>{r(!1),l()},1e3);return()=>clearTimeout(e)}},[o,l]);const m=s=>{e.length<4&&t(e=>e+s)},g=()=>{t(e=>e.slice(0,-1))},p=()=>x(this,null,function*(){4===e.length&&(yield a(e))});b.useEffect(()=>{4!==e.length||n||o||p()},[e,n,o]);const j=({number:e,onClick:t})=>u.jsx(h.button,{onClick:()=>t(e),className:`\n        ${c?"touch-target-lg":"w-16 h-16"} \n        rounded-touch bg-white border-2 border-gray-200 \n        ${c?"text-touch-lg":"text-2xl"} \n        font-semibold text-gray-800 \n        hover:bg-primary-50 hover:border-primary-300 \n        active:bg-primary-100\n        transition-all duration-200\n        shadow-touch hover:shadow-touch-lg\n      `,variants:de.keyButton,whileTap:"tap",whileHover:"hover",disabled:n,children:e}),v=()=>u.jsx(h.button,{onClick:g,className:`\n        ${c?"touch-target-lg":"w-16 h-16"} \n        rounded-touch bg-gray-100 border-2 border-gray-200 \n        flex items-center justify-center \n        hover:bg-gray-200 active:bg-gray-300\n        transition-all duration-200\n        shadow-touch hover:shadow-touch-lg\n      `,variants:de.keyButton,whileTap:"tap",whileHover:"hover",disabled:n||0===e.length,children:u.jsx("svg",{className:(c?"w-7 h-7":"w-6 h-6")+" text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2M3 12l6.414 6.414a2 2 0 001.414.586H19a2 2 0 002-2V7a2 2 0 00-2-2h-8.172a2 2 0 00-1.414.586L3 12z"})})});return u.jsx("div",{className:"min-h-screen bg-gradient-primary flex items-center justify-center p-4 safe-top safe-bottom",children:u.jsxs(h.div,{variants:de.container,initial:"initial",animate:"animate",className:`\n          bg-white rounded-touch-lg shadow-xl \n          ${d?"p-8 w-full max-w-md":"p-6 w-full max-w-sm"}\n        `,children:[u.jsx(h.div,{variants:de.logo,initial:"initial",animate:"animate",className:"flex justify-center mb-8",children:u.jsx(X,{size:d?"lg":"md"})}),u.jsxs("div",{className:"mb-6",children:[u.jsx("p",{className:"text-center text-gray-600 mb-4 "+(c?"text-lg":"text-base"),children:"Digite seu PIN de acesso"}),u.jsx("div",{className:"flex justify-center space-x-3 mb-8",children:[...Array(4)].map((t,r)=>u.jsx(h.div,{className:`\n              ${c?"w-5 h-5":"w-4 h-4"} \n              rounded-full border-2 transition-colors ${r<e.length?"bg-primary-500 border-primary-500":"border-gray-300"}`,animate:s?{x:[-10,10,-10,10,0]}:{},transition:{duration:.5}},r))})]}),o&&u.jsx(h.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},className:"bg-red-50 border border-red-200 rounded-lg p-3 mb-6",children:u.jsx("p",{className:"text-red-600 text-center text-sm",children:o})}),n&&u.jsxs("div",{className:"text-center mb-6",children:[u.jsx(ae,{size:"lg",className:"mx-auto text-primary-500"}),u.jsx("p",{className:"text-gray-600 text-sm mt-2",children:"Verificando..."})]}),u.jsxs(h.div,{variants:de.keypad,initial:"initial",animate:"animate",className:`grid grid-cols-3 ${c?"gap-6":"gap-4"} mb-6`,children:[[1,2,3,4,5,6,7,8,9].map(e=>u.jsx(j,{number:e,onClick:m},e)),u.jsx("div",{}),u.jsx(j,{number:0,onClick:m}),u.jsx(v,{})]}),!1]})})}function me({currentPage:e="dashboard",onNavigate:t,onCollapsedChange:s,className:r=""}){const[a,n]=b.useState(!1),{user:o,logout:l}=i(),{isTabletUp:d}=ie(),c=[{key:"dashboard",label:"Dashboard",icon:u.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2H5a2 2 0 00-2-2z"}),u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 5a2 2 0 012-2h4a2 2 0 012 2v2M8 5v2"})]}),roles:["admin","seller","separator","buyer"]},{key:"create-order",label:"Novo Pedido",icon:u.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),roles:["admin","seller"]},{key:"purchases",label:"Compras",icon:u.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"})}),roles:["admin","buyer"]},{key:"admin",label:"Administrativo",icon:u.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),roles:["admin"]}].filter(e=>e.roles.includes(null==o?void 0:o.role));return b.useEffect(()=>{s&&s(a)},[a,s]),d?u.jsxs("div",{className:`\n      sidebar-layout fixed left-0 top-0 h-full z-40\n      bg-white border-r border-gray-200 flex flex-col transition-all duration-300\n      ${a?"w-16":"w-64"} \n      ${r}\n    `,children:[u.jsx("div",{className:"p-4 border-b border-gray-200",children:u.jsxs("div",{className:"flex items-center justify-between",children:[!a&&u.jsxs("div",{className:"flex items-center space-x-3",children:[u.jsx("div",{className:"w-8 h-8 rounded-lg bg-orange-500 flex items-center justify-center",children:u.jsx("span",{className:"text-white font-bold text-sm",children:"PM"})}),u.jsxs("div",{children:[u.jsx("h1",{className:"text-lg font-bold text-gray-900",children:"PMCELL"}),u.jsx("p",{className:"text-xs text-gray-500",children:"Separação de Pedidos"})]})]}),u.jsx("button",{onClick:()=>n(!a),className:"p-1 rounded-lg hover:bg-gray-100 transition-colors",children:u.jsx("svg",{className:"w-5 h-5 text-gray-500 transition-transform "+(a?"rotate-180":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})})]})}),u.jsx("nav",{className:"flex-1 p-4",children:u.jsx("ul",{className:"space-y-2",children:c.map(s=>u.jsx("li",{children:u.jsxs("button",{onClick:()=>{return e=s.key,void(t&&t(e));var e},className:`\n                  w-full flex items-center rounded-lg transition-colors hover:bg-gray-100\n                  ${a?"justify-center px-2 py-3":"justify-start space-x-3 px-3 py-2 text-left"}\n                  ${e===s.key?"bg-orange-100 text-orange-700 "+(a?"rounded-lg":"border-r-2 border-orange-500"):"text-gray-700"}\n                `,title:a?s.label:"",children:[u.jsx("span",{className:"flex-shrink-0",children:s.icon}),!a&&u.jsx("span",{className:"text-sm font-medium",children:s.label})]})},s.key))})}),u.jsx("div",{className:"p-4 border-t border-gray-200",children:u.jsxs("div",{className:"flex items-center "+(a?"justify-center":"justify-between"),children:[u.jsxs("div",{className:"flex items-center space-x-3",children:[u.jsx("div",{className:"w-8 h-8 rounded-full bg-orange-500 flex items-center justify-center text-white text-xs font-medium",children:(m=(null==o?void 0:o.name)||"Usuario",m.split(" ").map(e=>e.charAt(0)).join("").substring(0,2).toUpperCase())}),!a&&u.jsxs("div",{className:"min-w-0 flex-1",children:[u.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:null==o?void 0:o.name}),u.jsx("p",{className:"text-xs text-gray-500 capitalize",children:"admin"===(null==o?void 0:o.role)?"Administrador":"seller"===(null==o?void 0:o.role)?"Vendedor":"separator"===(null==o?void 0:o.role)?"Separador":"buyer"===(null==o?void 0:o.role)?"Comprador":null==o?void 0:o.role})]})]}),!a&&u.jsx("button",{onClick:()=>{l()},className:"p-1 rounded-lg hover:bg-gray-100 transition-colors",title:"Sair",children:u.jsx("svg",{className:"w-5 h-5 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})})})]})})]}):null;var m}const xe=k((e=>(t,s,r)=>e((...e)=>{t(...e)},s,r))(n((e,t)=>({activeUsersByOrder:{},lastUpdate:null,updateOrderPresence:(t,s)=>{e(e=>({activeUsersByOrder:d(l({},e.activeUsersByOrder),{[t]:s}),lastUpdate:(new Date).toISOString()}))},addUserToOrder:(t,s)=>{e(e=>{const r=e.activeUsersByOrder[t]||[],a=r.findIndex(e=>e.id===s.id);let n;return a>=0?(n=[...r],n[a]=d(l({},s),{accessed_at:(new Date).toISOString()})):n=[...r,d(l({},s),{accessed_at:(new Date).toISOString()})],{activeUsersByOrder:d(l({},e.activeUsersByOrder),{[t]:n}),lastUpdate:(new Date).toISOString()}})},removeUserFromOrder:(t,s)=>{e(e=>{const r=(e.activeUsersByOrder[t]||[]).filter(e=>e.id!==s);return{activeUsersByOrder:d(l({},e.activeUsersByOrder),{[t]:r.length>0?r:void 0}),lastUpdate:(new Date).toISOString()}})},getActiveUsersForOrder:e=>{const{activeUsersByOrder:s}=t();return s[e]||[]},getUserCountForOrder:e=>t().getActiveUsersForOrder(e).length,isUserActiveInOrder:(e,s)=>t().getActiveUsersForOrder(e).some(e=>e.id===s),clearOrderPresence:t=>{e(e=>{const s=l({},e.activeUsersByOrder);return delete s[t],{activeUsersByOrder:s,lastUpdate:(new Date).toISOString()}})},clearAllPresence:()=>{e({activeUsersByOrder:{},lastUpdate:(new Date).toISOString()})},getDebugInfo:()=>{const e=t();return{totalOrders:Object.keys(e.activeUsersByOrder).length,totalUsers:Object.values(e.activeUsersByOrder).reduce((e,t)=>e+t.length,0),orderBreakdown:Object.entries(e.activeUsersByOrder).map(([e,t])=>({orderId:e,userCount:t.length,users:t.map(e=>({id:e.id,name:e.name}))})),lastUpdate:e.lastUpdate}}}),{name:"order-presence-storage",storage:r(()=>sessionStorage),partialize:e=>({activeUsersByOrder:{},lastUpdate:null})}))),ue=b.memo(function({user:e,size:t="md",showTooltip:s=!0,className:r=""}){const a=e.photo_url?u.jsx("img",{src:e.photo_url,alt:e.name,className:"w-full h-full object-cover"}):u.jsx("span",{className:"font-medium text-white",children:(n=e.name,n.split(" ").map(e=>e.charAt(0)).join("").substring(0,2).toUpperCase())});var n;const i=u.jsx(h.div,{className:`\n        ${{xs:"w-6 h-6 text-xs",sm:"w-8 h-8 text-xs",md:"w-10 h-10 text-sm",lg:"w-12 h-12 text-base",xl:"w-16 h-16 text-lg"}[t]} \n        rounded-full bg-primary-500 border-2 border-white \n        flex items-center justify-center\n        shadow-md hover:shadow-lg transition-shadow\n        ${r}\n      `,whileHover:{scale:1.05},whileTap:{scale:.95},children:a});return s&&e.name?u.jsxs("div",{className:"relative group",children:[i,u.jsx("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-2 py-1 text-xs text-white bg-gray-800 rounded opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none whitespace-nowrap z-10",children:e.name})]}):i}),he=b.memo(function({order:e,onCardClick:t,activeUsers:s=[],className:r=""}){const[a,n]=b.useState(!1),{orderAccessUser:o,currentOrderId:c}=i(),{getActiveUsersForOrder:m}=xe(),x=m(e.id),h=c===e.id&&o,g=[];return h&&o&&g.push(d(l({},o),{isCurrent:!0})),x.forEach(e=>{g.some(t=>t.id===e.id)||g.push(d(l({},e),{isCurrent:!1}))}),s&&s.length>0&&s.forEach(e=>{g.some(t=>t.id===e.id)||g.push(d(l({},e),{isCurrent:!1}))}),u.jsxs("div",{className:`\n        bg-white rounded-lg shadow-md border border-gray-200 p-6 \n        cursor-pointer transition-all duration-200 hover:shadow-lg hover:border-orange-300\n        ${a?"scale-[1.02]":""}\n        ${r}\n      `,onClick:()=>{t&&t(e)},onMouseEnter:()=>n(!0),onMouseLeave:()=>n(!1),children:[u.jsxs("div",{className:"flex items-center justify-between mb-3",children:[u.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Orçamento #",e.order_number]}),(e=>{const t={pending:{text:"Pendente",color:"bg-gray-100 text-gray-800"},in_progress:{text:"Em Separação",color:"bg-orange-100 text-orange-800"},completed:{text:"Concluído",color:"bg-green-100 text-green-800"},paused:{text:"Pausado",color:"bg-yellow-100 text-yellow-800"}},s=t[e]||t.pending;return u.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${s.color}`,children:s.text})})(e.status)]}),u.jsxs("div",{className:"mb-3",children:[u.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Cliente"}),u.jsx("p",{className:"font-medium text-gray-900 truncate",title:e.client,children:e.client})]}),u.jsxs("div",{className:"mb-3",children:[u.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Vendedor"}),u.jsx("p",{className:"font-medium text-gray-900 truncate",title:e.seller,children:e.seller})]}),u.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Itens"}),u.jsx("p",{className:"font-medium text-gray-900",children:e.items_count})]}),u.jsxs("div",{children:[u.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Valor"}),u.jsx("p",{className:"font-medium text-gray-900",children:(j=e.value,new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(j))})]})]}),u.jsxs("div",{className:"mb-4",children:[u.jsxs("div",{className:"flex items-center justify-between mb-2",children:[u.jsx("p",{className:"text-sm text-gray-600",children:"Progresso"}),u.jsxs("p",{className:"text-sm font-medium text-gray-900",children:[e.progress.toFixed(2),"%"]})]}),u.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:u.jsx("div",{className:"h-2 rounded-full transition-all duration-300 "+(p=e.progress,100===p?"bg-green-500":p>=50?"bg-orange-500":"bg-red-500"),style:{width:`${e.progress}%`}})})]}),g.length>0&&u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsxs("p",{className:"text-xs text-gray-600",children:["Acessando (",g.length,"):"]}),u.jsxs("div",{className:"flex -space-x-2",children:[g.slice(0,4).map((e,t)=>u.jsxs("div",{className:"relative",children:[u.jsx(ue,{user:e,size:"sm",showTooltip:!0,className:e.isCurrent?"ring-2 ring-primary-500 ring-offset-2":""}),e.isCurrent&&u.jsx("div",{className:"absolute -top-1 -right-1 w-3 h-3 bg-primary-500 rounded-full border-2 border-white",children:u.jsx("div",{className:"w-full h-full bg-primary-500 rounded-full animate-pulse"})})]},e.id||t)),g.length>4&&u.jsxs("div",{className:"w-8 h-8 rounded-full bg-gray-400 border-2 border-white flex items-center justify-center text-white text-xs font-medium",children:["+",g.length-4]})]})]})]});var p,j});function ge({orders:e=[],loading:t=!1,onOrderClick:s,activeUsers:r={},className:a=""}){const[n,i]=b.useState(e);return b.useEffect(()=>{i(e)},[e]),t?u.jsx("div",{className:`grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 ${a}`,children:Array.from({length:8}).map((e,t)=>u.jsxs("div",{className:"bg-white rounded-lg shadow-md border border-gray-200 p-6 animate-pulse",children:[u.jsxs("div",{className:"flex items-center justify-between mb-3",children:[u.jsx("div",{className:"h-6 bg-gray-300 rounded w-32"}),u.jsx("div",{className:"h-6 bg-gray-300 rounded w-20"})]}),u.jsxs("div",{className:"mb-3",children:[u.jsx("div",{className:"h-4 bg-gray-300 rounded w-16 mb-1"}),u.jsx("div",{className:"h-5 bg-gray-300 rounded w-full"})]}),u.jsxs("div",{className:"mb-3",children:[u.jsx("div",{className:"h-4 bg-gray-300 rounded w-20 mb-1"}),u.jsx("div",{className:"h-5 bg-gray-300 rounded w-full"})]}),u.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[u.jsxs("div",{children:[u.jsx("div",{className:"h-4 bg-gray-300 rounded w-12 mb-1"}),u.jsx("div",{className:"h-5 bg-gray-300 rounded w-8"})]}),u.jsxs("div",{children:[u.jsx("div",{className:"h-4 bg-gray-300 rounded w-16 mb-1"}),u.jsx("div",{className:"h-5 bg-gray-300 rounded w-20"})]})]}),u.jsxs("div",{className:"mb-4",children:[u.jsxs("div",{className:"flex items-center justify-between mb-2",children:[u.jsx("div",{className:"h-4 bg-gray-300 rounded w-16"}),u.jsx("div",{className:"h-4 bg-gray-300 rounded w-10"})]}),u.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:u.jsx("div",{className:"h-2 bg-gray-300 rounded-full w-1/2"})})]})]},t))}):e&&0!==e.length?u.jsx("div",{className:`grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 ${a}`,children:n.map(e=>u.jsx(he,{order:e,onCardClick:s,activeUsers:r[e.id]||[]},e.id))}):u.jsx("div",{className:`flex flex-col items-center justify-center py-12 ${a}`,children:u.jsxs("div",{className:"text-center",children:[u.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-gray-100 rounded-full flex items-center justify-center",children:u.jsx("svg",{className:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),u.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Nenhum pedido encontrado"}),u.jsx("p",{className:"text-gray-500",children:"Não há pedidos para exibir no momento."})]})})}const pe=b.memo(function({onFilterChange:e,currentFilter:t="all",orderCounts:s={},className:r=""}){const[a,n]=b.useState(t);return u.jsx("div",{className:`flex flex-wrap gap-2 ${r}`,children:[{key:"all",label:"Todos",color:"bg-gray-100 text-gray-800 border-gray-300",activeColor:"bg-gray-800 text-white border-gray-800"},{key:"pending",label:"Pendentes",color:"bg-gray-100 text-gray-800 border-gray-300",activeColor:"bg-gray-800 text-white border-gray-800"},{key:"in_progress",label:"Em Separação",color:"bg-orange-100 text-orange-800 border-orange-300",activeColor:"bg-orange-600 text-white border-orange-600"},{key:"completed",label:"Concluídos",color:"bg-green-100 text-green-800 border-green-300",activeColor:"bg-green-600 text-white border-green-600"},{key:"paused",label:"Pausados",color:"bg-yellow-100 text-yellow-800 border-yellow-300",activeColor:"bg-yellow-600 text-white border-yellow-600"}].map(t=>{const r=a===t.key,i="all"===(o=t.key)?Object.values(s).reduce((e,t)=>e+t,0):s[o]||0;var o;return u.jsxs("button",{onClick:()=>(t=>{n(t),e&&e(t)})(t.key),className:`\n              inline-flex items-center px-4 py-2 rounded-full text-sm font-medium border\n              transition-all duration-200 hover:scale-105 focus:outline-none focus:ring-2 focus:ring-orange-500 focus:ring-offset-2\n              ${r?t.activeColor:t.color}\n            `,children:[u.jsx("span",{children:t.label}),i>0&&u.jsx("span",{className:`\n                ml-2 inline-flex items-center justify-center px-2 py-1 text-xs font-bold rounded-full\n                ${r?"bg-white bg-opacity-25 text-current":"bg-gray-800 bg-opacity-10 text-current"}\n              `,children:i})]},t.key)})})}),be=C.create({baseURL:"https://pmcell-backend.onrender.com/api/v1",timeout:1e4,headers:{"Content-Type":"application/json"}});function je({isOpen:e,onClose:t,order:s,onSuccess:r}){const[a,n]=b.useState(""),[i,o]=b.useState(!1),[l,d]=b.useState(!1),[c,m]=b.useState(null),{isTouchDevice:p}=ie();b.useEffect(()=>{if(c){o(!0),n("");const e=setTimeout(()=>{o(!1),m(null)},1e3);return()=>clearTimeout(e)}},[c]),b.useEffect(()=>{e&&(n(""),m(null),d(!1))},[e]);const j=e=>{a.length<4&&n(t=>t+e)},v=()=>{n(e=>e.slice(0,-1))},f=()=>x(this,null,function*(){var e,n;if(4===a.length){d(!0),m(null);try{const e=(yield be.post("/auth/order-access",{order_id:s.id,pin:a})).data;r(e.user,s),t()}catch(i){const t=(null==(n=null==(e=i.response)?void 0:e.data)?void 0:n.detail)||i.message||"Erro de conexão";m(t)}finally{d(!1)}}});b.useEffect(()=>{4!==a.length||l||c||f()},[a,l,c]);const y=({number:e,onClick:t})=>u.jsx(h.button,{onClick:()=>t(e),className:`\n        ${p?"touch-target-lg":"w-16 h-16"} \n        rounded-touch bg-white border-2 border-gray-200 \n        ${p?"text-touch-lg":"text-2xl"} \n        font-semibold text-gray-800 \n        hover:bg-primary-50 hover:border-primary-300 \n        active:bg-primary-100\n        transition-all duration-200\n        shadow-touch hover:shadow-touch-lg\n      `,variants:de.keyButton,whileTap:"tap",whileHover:"hover",disabled:l,children:e}),N=()=>u.jsx(h.button,{onClick:v,className:`\n        ${p?"touch-target-lg":"w-16 h-16"} \n        rounded-touch bg-gray-100 border-2 border-gray-200 \n        flex items-center justify-center \n        hover:bg-gray-200 active:bg-gray-300\n        transition-all duration-200\n        shadow-touch hover:shadow-touch-lg\n      `,variants:de.keyButton,whileTap:"tap",whileHover:"hover",disabled:l||0===a.length,children:u.jsx("svg",{className:(p?"w-7 h-7":"w-6 h-6")+" text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2M3 12l6.414 6.414a2 2 0 001.414.586H19a2 2 0 002-2V7a2 2 0 00-2-2h-8.172a2 2 0 00-1.414.586L3 12z"})})});return u.jsx(g,{children:e&&u.jsx(h.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",onClick:t,children:u.jsxs(h.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},transition:{type:"spring",stiffness:300,damping:30},className:"bg-white rounded-touch-lg shadow-xl p-6 w-full max-w-md",onClick:e=>e.stopPropagation(),children:[u.jsxs("div",{className:"flex items-center justify-between mb-6",children:[u.jsxs("div",{children:[u.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Acesso ao Pedido"}),u.jsxs("p",{className:"text-sm text-gray-600",children:["Orçamento #",null==s?void 0:s.order_number]})]}),u.jsx("button",{onClick:t,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:u.jsx(Y,{className:"w-5 h-5 text-gray-400"})})]}),u.jsxs("div",{className:"mb-6",children:[u.jsx("p",{className:"text-center text-gray-600 mb-4 "+(p?"text-lg":"text-base"),children:"Digite seu PIN para acessar"}),u.jsx("div",{className:"flex justify-center space-x-3 mb-8",children:[...Array(4)].map((e,t)=>u.jsx(h.div,{className:`\n              ${p?"w-5 h-5":"w-4 h-4"} \n              rounded-full border-2 transition-colors ${t<a.length?"bg-primary-500 border-primary-500":"border-gray-300"}`,animate:i?{x:[-10,10,-10,10,0]}:{},transition:{duration:.5}},t))})]}),c&&u.jsx(h.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},className:"bg-red-50 border border-red-200 rounded-lg p-3 mb-6",children:u.jsx("p",{className:"text-red-600 text-center text-sm",children:c})}),l&&u.jsxs("div",{className:"text-center mb-6",children:[u.jsx(ae,{size:"lg",className:"mx-auto text-primary-500"}),u.jsx("p",{className:"text-gray-600 text-sm mt-2",children:"Verificando..."})]}),u.jsxs(h.div,{variants:de.keypad,initial:"initial",animate:"animate",className:`grid grid-cols-3 ${p?"gap-6":"gap-4"} mb-6`,children:[[1,2,3,4,5,6,7,8,9].map(e=>u.jsx(y,{number:e,onClick:j},e)),u.jsx("div",{}),u.jsx(y,{number:0,onClick:j}),u.jsx(N,{})]}),u.jsx("button",{onClick:t,className:"w-full py-3 px-4 text-gray-600 hover:text-gray-800 transition-colors text-center",children:"Cancelar"})]})})})}function ve({width:e="w-full",height:t="h-4",className:s="",animated:r=!0}){const a=`bg-gray-200 rounded ${e} ${t} ${s}`;return r?u.jsx(h.div,{className:a,animate:{opacity:[.5,1,.5]},transition:{duration:1.5,repeat:1/0,ease:"easeInOut"}}):u.jsx("div",{className:a})}function fe({className:e=""}){return u.jsxs("div",{className:`card p-6 ${e}`,children:[u.jsxs("div",{className:"flex items-start justify-between mb-4",children:[u.jsxs("div",{className:"flex-1",children:[u.jsx(ve,{width:"w-24",height:"h-5",className:"mb-2"}),u.jsx(ve,{width:"w-32",height:"h-4"})]}),u.jsx(ve,{width:"w-16",height:"h-6"})]}),u.jsxs("div",{className:"space-y-3 mb-4",children:[u.jsxs("div",{children:[u.jsx(ve,{width:"w-16",height:"h-3",className:"mb-1"}),u.jsx(ve,{width:"w-40",height:"h-4"})]}),u.jsxs("div",{children:[u.jsx(ve,{width:"w-20",height:"h-3",className:"mb-1"}),u.jsx(ve,{width:"w-32",height:"h-4"})]})]}),u.jsxs("div",{className:"space-y-3 mb-4",children:[u.jsxs("div",{className:"flex justify-between items-center",children:[u.jsx(ve,{width:"w-12",height:"h-3"}),u.jsx(ve,{width:"w-20",height:"h-4"})]}),u.jsxs("div",{children:[u.jsx(ve,{width:"w-full",height:"h-2",className:"mb-1"}),u.jsxs("div",{className:"flex justify-between",children:[u.jsx(ve,{width:"w-16",height:"h-3"}),u.jsx(ve,{width:"w-12",height:"h-3"})]})]})]}),u.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-gray-100",children:[u.jsxs("div",{className:"flex -space-x-2",children:[u.jsx(ve,{width:"w-8",height:"h-8",className:"rounded-full"}),u.jsx(ve,{width:"w-8",height:"h-8",className:"rounded-full"})]}),u.jsx(ve,{width:"w-16",height:"h-3"})]})]})}function ye({className:e=""}){return u.jsxs("div",{className:`flex items-center justify-between p-4 bg-white ${e}`,children:[u.jsxs("div",{className:"flex items-center space-x-3",children:[u.jsx(ve,{width:"w-10",height:"h-10",className:"rounded-full"}),u.jsxs("div",{children:[u.jsx(ve,{width:"w-32",height:"h-5",className:"mb-1"}),u.jsx(ve,{width:"w-24",height:"h-3"})]})]}),u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx(ve,{width:"w-8",height:"h-8",className:"rounded-lg"}),u.jsx(ve,{width:"w-8",height:"h-8",className:"rounded-lg"})]})]})}function Ne({className:e=""}){return u.jsxs("div",{className:`space-y-6 ${e}`,children:[u.jsx(ye,{}),u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[1,2,3].map(e=>u.jsx("div",{className:"card p-6",children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsx(ve,{width:"w-16",height:"h-4",className:"mb-2"}),u.jsx(ve,{width:"w-12",height:"h-8"})]}),u.jsx(ve,{width:"w-12",height:"h-12",className:"rounded-xl"})]})},e))}),u.jsx("div",{className:"grid-responsive",children:Array.from({length:6}).map((e,t)=>u.jsx(fe,{},t))})]})}function we(){const{user:e,setOrderAccess:t}=i(),{showSuccess:s,showError:r,showInfo:a}=O(),n=j(),{isTabletUp:o,isMobile:l}=ie(),{orders:d,loading:c,error:m,refetch:g,hasInitiallyLoaded:p}=function(){const[e,t]=b.useState([]),[s,r]=b.useState(!1),[a,n]=b.useState(null),o=b.useRef(!1),l=b.useRef(!1),{showError:d}=O(),{isAuthenticated:c}=i(),m=b.useCallback((e=!1)=>x(this,null,function*(){if(!l.current||e)try{l.current=!0,r(!0),n(null);const e=(yield be.get("/orders")).data.map(e=>({id:e.id,order_number:e.order_number,client:e.client_name,seller:e.seller_name,value:e.total_value,status:0===e.progress_percentage?"pending":100===e.progress_percentage?"completed":"in_progress",items_count:e.items_count,progress:e.progress_percentage,created_at:e.created_at}));t(e),o.current=!0}catch(s){const e=s.message||"Erro ao carregar pedidos";n(e),o.current=!0,d(e)}finally{r(!1),l.current=!1}}),[d]);return b.useEffect(()=>{if(!c)return void(o.current=!0);if(o.current)return;const e=setTimeout(()=>{m()},100);return()=>clearTimeout(e)},[c]),{orders:e,loading:s,error:a,refetch:b.useCallback(()=>{m(!0)},[m]),hasInitiallyLoaded:o.current}}(),{isConnected:v,fetchActiveUsers:f}=function(){const{activeUsersByOrder:e,updateOrderPresence:t,addUserToOrder:s,removeUserFromOrder:r,getActiveUsersForOrder:a,getUserCountForOrder:n,isUserActiveInOrder:o}=xe(),{user:l,token:d}=i(),c=b.useRef(null),u=b.useRef(null),h=b.useRef(!1),g=b.useCallback(()=>{if(l&&d&&!h.current)try{const e=`ws://localhost:8000/api/v1/ws/orders?token=${d}`;c.current=new WebSocket(e),c.current.onopen=()=>{h.current=!0,u.current&&(clearTimeout(u.current),u.current=null)},c.current.onmessage=e=>{try{const t=JSON.parse(e.data);p(t)}catch(m){}},c.current.onclose=()=>{h.current=!1,u.current=setTimeout(()=>{g()},3e3)},c.current.onerror=e=>{h.current=!1}}catch(m){}},[l,d]),p=b.useCallback(a=>{const{type:n,data:i}=a;switch(n){case"order_access":i.order_id&&i.user&&s(i.order_id,{id:i.user.id,name:i.user.name,role:i.user.role,photo_url:i.user.photo_url});break;case"presence_update":i.order_id&&i.active_users&&t(i.order_id,i.active_users.map(e=>({id:e.user_id,name:e.user_name,role:e.role||"unknown",photo_url:e.photo_url||null,connected_at:e.connected_at})));break;case"user_joined":i.order_id&&i.user_id&&i.user_name&&s(i.order_id,{id:i.user_id,name:i.user_name,role:i.role||"unknown",photo_url:i.photo_url||null});break;case"user_left":i.user_id&&Object.keys(e).forEach(e=>{r(parseInt(e),i.user_id)})}},[s,t,r,e]),j=b.useCallback(e=>x(this,null,function*(){try{const s=(yield be.get(`/auth/orders/${e}/active-users`)).data.map(e=>({id:e.user_id,name:e.user_name,role:"unknown",photo_url:null,connected_at:e.connected_at}));return t(e,s),s}catch(m){return[]}}),[d,t]);return b.useEffect(()=>(g(),()=>{c.current&&(c.current.close(),c.current=null),u.current&&(clearTimeout(u.current),u.current=null),h.current=!1}),[g]),{activeUsersByOrder:e,isConnected:h.current,getActiveUsersForOrder:a,getUserCountForOrder:n,isUserActiveInOrder:o,fetchActiveUsers:j,updateOrderPresence:t,addUserToOrder:s,removeUserFromOrder:r,reconnect:g}}(),[y,N]=b.useState("dashboard"),[w,k]=b.useState("all"),[C,_]=b.useState([]),[S,E]=b.useState({}),[L,I]=b.useState({}),[$,P]=b.useState(!1),[M,A]=b.useState(!1),[T,B]=b.useState(null),z=b.useRef(!1);return b.useEffect(()=>{!p||c||z.current||(!m&&d.length>0?(s(`Dashboard carregado com sucesso! ${d.length} pedidos encontrados.`),z.current=!0):m||0!==d.length||(a("Nenhum pedido encontrado. Faça upload de um PDF para criar um novo pedido."),z.current=!0))},[p,c,m,d.length]),b.useEffect(()=>{_("all"===w?d:d.filter(e=>e.status===w));const e=d.reduce((e,t)=>(e[t.status]=(e[t.status]||0)+1,e),{});E(e)},[d,w]),c&&!p?u.jsx(Ne,{}):u.jsxs("div",{className:"min-h-screen bg-gray-50 safe-top safe-bottom",children:[u.jsx(se,{children:u.jsx(me,{currentPage:y,onNavigate:e=>{N(e),"purchases"===e?(n("/purchase-items"),a("Navegando para tela de compras")):"admin"===e?(n("/admin"),a("Navegando para painel administrativo")):"create-order"===e?(n("/novo-pedido"),a("Navegando para criação de novo pedido")):a(`Navegando para ${e}`)},onCollapsedChange:e=>{P(e)}})}),u.jsxs("div",{className:"main-content flex flex-col min-h-screen "+(o?$?"ml-16":"ml-64":"ml-0"),children:[u.jsx(h.header,{initial:{y:-50,opacity:0},animate:{y:0,opacity:1},className:"bg-white shadow-sm border-b",children:u.jsx("div",{className:"px-4 py-4",children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{className:"flex items-center space-x-4",children:[!o&&u.jsx(X,{size:"sm"}),u.jsxs("div",{children:[u.jsx("h1",{className:"font-bold text-gray-900 "+(l?"text-xl":"text-2xl"),children:"Dashboard de Pedidos"}),u.jsx("p",{className:"text-gray-600 text-sm",children:"Gerencie e acompanhe os pedidos em separação"})]})]}),u.jsxs("div",{className:"text-right",children:[u.jsx("p",{className:"text-sm text-gray-600",children:"Bem-vindo,"}),u.jsx("p",{className:"font-medium text-gray-900",children:null==e?void 0:e.name}),u.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[u.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-primary-100 text-primary-800",children:null==e?void 0:e.role}),u.jsxs("div",{className:"flex items-center space-x-1",children:[u.jsx("div",{className:"h-2 w-2 rounded-full "+(v?"bg-green-500":"bg-red-500")}),u.jsx("span",{className:"text-xs text-gray-500",children:v?"Online":"Offline"})]})]})]})]})})}),u.jsx("main",{className:"flex-1 px-4 py-2 tablet:px-4 tablet:py-4",children:u.jsxs(h.div,{variants:oe,initial:"initial",animate:"animate",className:"space-y-6",children:[u.jsxs(h.div,{variants:le.statsCard,className:"grid grid-cols-2 tablet:grid-cols-4 gap-4 tablet:gap-6",children:[u.jsx("div",{className:"card card-hover touch-padding",children:u.jsxs("div",{className:"flex items-center",children:[u.jsx("div",{className:"w-12 h-12 bg-primary-100 rounded-xl flex items-center justify-center",children:u.jsx("svg",{className:"w-6 h-6 text-primary-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),u.jsxs("div",{className:"ml-4",children:[u.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total"}),u.jsx("p",{className:"font-bold text-gray-900 "+(l?"text-xl":"text-2xl"),children:d.length})]})]})}),u.jsx("div",{className:"card card-hover touch-padding",children:u.jsxs("div",{className:"flex items-center",children:[u.jsx("div",{className:"w-12 h-12 bg-yellow-100 rounded-xl flex items-center justify-center",children:u.jsx("svg",{className:"w-6 h-6 text-yellow-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}),u.jsxs("div",{className:"ml-4",children:[u.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Pendentes"}),u.jsx("p",{className:"font-bold text-gray-900 "+(l?"text-xl":"text-2xl"),children:S.pending||0})]})]})}),u.jsx("div",{className:"card card-hover touch-padding",children:u.jsxs("div",{className:"flex items-center",children:[u.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-xl flex items-center justify-center",children:u.jsx("svg",{className:"w-6 h-6 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"})})}),u.jsxs("div",{className:"ml-4",children:[u.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Em Separação"}),u.jsx("p",{className:"font-bold text-gray-900 "+(l?"text-xl":"text-2xl"),children:S.in_progress||0})]})]})}),u.jsx("div",{className:"card card-hover touch-padding",children:u.jsxs("div",{className:"flex items-center",children:[u.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-xl flex items-center justify-center",children:u.jsx("svg",{className:"w-6 h-6 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),u.jsxs("div",{className:"ml-4",children:[u.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Concluídos"}),u.jsx("p",{className:"font-bold text-gray-900 "+(l?"text-xl":"text-2xl"),children:S.completed||0})]})]})})]}),u.jsxs(h.div,{variants:le.statsCard,className:"card touch-padding",children:[u.jsxs("div",{className:"flex items-center justify-between mb-4",children:[u.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Filtrar Pedidos"}),u.jsx("button",{onClick:g,disabled:c,className:"btn-ghost text-sm touch-target disabled:opacity-50",children:c?"Carregando...":"Atualizar"})]}),u.jsx(se,{children:u.jsx(pe,{onFilterChange:e=>{k(e)},currentFilter:w,orderCounts:S})})]}),u.jsxs(h.div,{variants:le.statsCard,className:"card",children:[u.jsx("div",{className:"touch-padding border-b border-gray-200",children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Pedidos (",C.length,")"]}),u.jsx("div",{className:"flex items-center space-x-2",children:"all"!==w&&u.jsx("span",{className:"badge badge-in-progress",children:w})})]})}),u.jsx(se,{children:u.jsx(ge,{orders:C,loading:c,onOrderClick:e=>{B(e),A(!0)},activeUsers:L,className:"p-4"})})]})]})})]}),u.jsx(je,{isOpen:M,onClose:()=>{A(!1),B(null)},order:T,onSuccess:(e,r)=>x(this,null,function*(){t(e,r.id);try{yield f(r.id)}catch(a){}n(`/orders/${r.id}/separation`),s(`Acesso autorizado! Abrindo separação do pedido #${r.order_number}`)})})]})}be.interceptors.request.use(e=>{const t=(()=>{try{const e=localStorage.getItem("auth-storage");if(e)return JSON.parse(e).state}catch(e){}return null})();let s=(null==t?void 0:t.token)||localStorage.getItem("auth_token");return s&&(e.headers.Authorization=`Bearer ${s}`),e},e=>Promise.reject(e)),be.interceptors.response.use(e=>e,e=>{var t,s,r,a,n,i;if(401===(null==(t=e.response)?void 0:t.status)){localStorage.removeItem("auth_token");try{const e=localStorage.getItem("auth-storage");if(e){const t=JSON.parse(e);t.state.isAuthenticated=!1,t.state.user=null,t.state.token=null,localStorage.setItem("auth-storage",JSON.stringify(t))}}catch(c){}}const o=d(l({},e),{isNetworkError:"ECONNABORTED"===e.code||e.message.includes("Network Error"),isTimeoutError:"ECONNABORTED"===e.code&&e.message.includes("timeout"),status:null==(s=e.response)?void 0:s.status,message:(null==(a=null==(r=e.response)?void 0:r.data)?void 0:a.detail)||(null==(i=null==(n=e.response)?void 0:n.data)?void 0:i.message)||e.message});return Promise.reject(o)});const ke={app:!0,dashboard:!0,useOrders:!0,authStore:!0,toastProvider:!0,api:!0},Ce=(e,t,s={})=>{ke[e]},_e=e=>"undefined"!=typeof window&&window.debugCounters?(window.debugCounters[e]=(window.debugCounters[e]||0)+1,window.debugCounters[e]):0;function Se(){var e,t,s,r;const a=j(),{addToast:n}=O(),{isTabletUp:i}=ie(),[o,c]=b.useState(1),[m,h]=b.useState({logistics:"",packageType:"",observations:""}),[g,p]=b.useState(null),[v,f]=b.useState(null),[y,N]=b.useState(null),[w,k]=b.useState(!1),[C,_]=b.useState(!1);Ce("newOrder",0,{step:o,hasFile:!!g,hasExtractedData:!!v,renderCount:_e("newOrderRender")});const S=(e,t)=>{h(s=>d(l({},s),{[e]:t}))},E=e=>x(this,null,function*(){var t;if(e&&"application/pdf"===e.type){k(!0),p(e);try{const t=new FormData;t.append("file",e);const s=yield be.post("/orders/upload",t,{headers:{"Content-Type":"multipart/form-data"}});if(!s.data.success||!s.data.data)throw new Error(s.data.message||"Erro ao processar PDF");f(s.data.data),N(s.data.validation_info),n(s.data.message||"PDF processado com sucesso!","success"),Ce("newOrder",0,{fileName:e.name,extractedData:s.data})}catch(s){p(null),f(null),N(null);let e="Erro ao processar PDF";if(null==(t=s.response)?void 0:t.data){const t=s.response.data;t.message?e=t.message:t.errors&&Array.isArray(t.errors)?e=t.errors.join(", "):t.detail&&(e=t.detail)}else s.message&&(e=s.message);n(e,"error")}finally{k(!1)}}else n("Por favor, selecione um arquivo PDF válido","error")}),L=()=>v&&m.logistics&&m.packageType;return u.jsxs("div",{className:"min-h-screen bg-gray-50",children:[u.jsx(me,{onCollapsedChange:e=>{_(e)}}),u.jsx("div",{className:"main-content min-h-screen overflow-auto "+(i?C?"ml-16":"ml-64":"ml-0"),children:u.jsxs("div",{className:"max-w-4xl mx-auto p-6",children:[u.jsxs("div",{className:"mb-8",children:[u.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"📦 Novo Pedido"}),u.jsx("p",{className:"text-gray-600",children:"Faça upload do PDF do pedido e configure as informações de entrega"})]}),u.jsx("div",{className:"mb-8",children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{className:"flex items-center "+(o>=1?"text-orange-600":"text-gray-400"),children:[u.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center border-2 \n                  "+(o>=1?"border-orange-600 bg-orange-600 text-white":"border-gray-300"),children:"1"}),u.jsx("span",{className:"ml-2 font-medium",children:"Upload"})]}),u.jsx("div",{className:"flex-1 h-1 mx-4 "+(o>=2?"bg-orange-600":"bg-gray-300")}),u.jsxs("div",{className:"flex items-center "+(o>=2?"text-orange-600":"text-gray-400"),children:[u.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center border-2 \n                  "+(o>=2?"border-orange-600 bg-orange-600 text-white":"border-gray-300"),children:"2"}),u.jsx("span",{className:"ml-2 font-medium",children:"Preview"})]}),u.jsx("div",{className:"flex-1 h-1 mx-4 "+(o>=3?"bg-orange-600":"bg-gray-300")}),u.jsxs("div",{className:"flex items-center "+(o>=3?"text-orange-600":"text-gray-400"),children:[u.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center border-2 \n                  "+(o>=3?"border-orange-600 bg-orange-600 text-white":"border-gray-300"),children:"3"}),u.jsx("span",{className:"ml-2 font-medium",children:"Confirmar"})]})]})}),1===o&&u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:[u.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"📄 Upload do PDF"}),u.jsxs("div",{className:"border-2 border-dashed rounded-lg p-8 text-center transition-colors\n                    "+(w?"border-orange-400 bg-orange-50":g?"border-green-400 bg-green-50":"border-gray-300 hover:border-orange-400"),onDragOver:e=>{e.preventDefault(),e.stopPropagation()},onDrop:e=>{e.preventDefault(),e.stopPropagation();const t=e.dataTransfer.files;t.length>0&&E(t[0])},children:[u.jsx("div",{className:"mb-4",children:w?u.jsxs("svg",{className:"animate-spin mx-auto h-12 w-12 text-orange-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[u.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),u.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):g&&v?u.jsx("svg",{className:"mx-auto h-12 w-12 text-green-500",fill:"currentColor",viewBox:"0 0 20 20",children:u.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}):u.jsx("svg",{className:"mx-auto h-12 w-12 text-gray-400",stroke:"currentColor",fill:"none",viewBox:"0 0 48 48",children:u.jsx("path",{d:"M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8m-12 4h.02",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}),u.jsx("div",{className:"text-lg font-medium text-gray-900 mb-2",children:w?u.jsx("span",{className:"text-orange-600",children:"Processando PDF..."}):g&&v?u.jsxs("span",{className:"text-green-600",children:["✓ ",g.name," - Processado com sucesso!"]}):g?u.jsxs("span",{className:"text-yellow-600",children:["📄 ",g.name," - Processando..."]}):"Arraste o PDF aqui ou clique para selecionar"}),u.jsx("p",{className:"text-gray-500 mb-4",children:w?"Extraindo dados do PDF, aguarde...":g&&v?`${(null==(e=v.items)?void 0:e.length)||0} itens extraídos com sucesso`:"Apenas arquivos PDF são aceitos"}),!w&&u.jsxs(u.Fragment,{children:[u.jsx("input",{type:"file",accept:".pdf",onChange:e=>{const t=e.target.files[0];t&&E(t)},className:"hidden",id:"file-upload",disabled:w}),u.jsx("label",{htmlFor:"file-upload",className:"inline-flex items-center px-4 py-2 rounded-lg cursor-pointer transition-colors\n                          "+(g&&v?"bg-green-600 text-white hover:bg-green-700":"bg-orange-600 text-white hover:bg-orange-700"),children:g&&v?"Trocar Arquivo":"Selecionar Arquivo"})]})]})]}),u.jsxs("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:[u.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"🚚 Tipo de Logística"}),u.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3",children:["Lalamove","Correios","Melhor Envio","Retirada","Entrega","Cliente na loja","Ônibus"].map(e=>u.jsx("button",{onClick:()=>S("logistics",e),className:"p-3 rounded-lg border text-sm font-medium transition-all\n                        "+(m.logistics===e?"border-orange-600 bg-orange-50 text-orange-700":"border-gray-300 hover:border-gray-400"),children:e},e))})]}),u.jsxs("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:[u.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"📦 Tipo de Embalagem"}),u.jsx("div",{className:"flex gap-3",children:["Caixa","Sacola"].map(e=>u.jsx("button",{onClick:()=>S("packageType",e),className:"flex-1 p-4 rounded-lg border font-medium transition-all\n                        "+(m.packageType===e?"border-orange-600 bg-orange-50 text-orange-700":"border-gray-300 hover:border-gray-400"),children:e},e))})]}),u.jsxs("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:[u.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"📝 Observações"}),u.jsx("textarea",{value:m.observations,onChange:e=>S("observations",e.target.value),placeholder:"Observações adicionais para o pedido...",className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent resize-none",rows:4})]}),u.jsxs("div",{className:"flex justify-between",children:[u.jsx("button",{onClick:()=>a("/"),className:"px-6 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancelar"}),u.jsx("button",{onClick:()=>c(2),disabled:!L(),className:"px-6 py-3 rounded-lg font-medium transition-colors\n                    "+(L()?"bg-orange-600 text-white hover:bg-orange-700":"bg-gray-300 text-gray-500 cursor-not-allowed"),children:"Próximo: Preview"})]})]}),2===o&&v&&u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:[u.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"👀 Preview do Pedido"}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Número do Orçamento"}),u.jsx("input",{type:"text",value:v.order_number||"",readOnly:!0,className:"w-full p-2 border border-gray-300 rounded-lg bg-gray-50"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Cliente"}),u.jsx("input",{type:"text",value:v.client_name||"",readOnly:!0,className:"w-full p-2 border border-gray-300 rounded-lg bg-gray-50"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Vendedor"}),u.jsx("input",{type:"text",value:v.seller_name||"",readOnly:!0,className:"w-full p-2 border border-gray-300 rounded-lg bg-gray-50"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Data"}),u.jsx("input",{type:"text",value:v.order_date?new Date(v.order_date).toLocaleDateString("pt-BR"):"",readOnly:!0,className:"w-full p-2 border border-gray-300 rounded-lg bg-gray-50"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Valor Total"}),u.jsx("input",{type:"text",value:v.total_value?`R$ ${v.total_value}`:"",readOnly:!0,className:"w-full p-2 border border-gray-300 rounded-lg bg-gray-50"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Total de Itens"}),u.jsx("input",{type:"text",value:v.items?v.items.length:"0",readOnly:!0,className:"w-full p-2 border border-gray-300 rounded-lg bg-gray-50"})]})]}),y&&u.jsxs("div",{className:`border-t pt-4 ${y.totals_match?"bg-green-50":"bg-red-50"} p-4 rounded-lg border`,children:[u.jsx("h3",{className:"text-lg font-medium mb-3 flex items-center",children:y.totals_match?u.jsx("span",{className:"text-green-600",children:"✅ Validação Aprovada"}):u.jsx("span",{className:"text-red-600",children:"❌ Atenção: Divergência Encontrada"})}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block font-medium text-gray-700 mb-1",children:"Valor Calculado (Soma dos Itens)"}),u.jsxs("div",{className:"text-lg font-bold text-blue-600",children:["R$ ",null==(t=y.calculated_total)?void 0:t.toFixed(2)]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block font-medium text-gray-700 mb-1",children:"Valor do PDF"}),u.jsxs("div",{className:"text-lg font-bold text-gray-800",children:["R$ ",null==(s=y.pdf_total)?void 0:s.toFixed(2)]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block font-medium text-gray-700 mb-1",children:"Diferença"}),u.jsxs("div",{className:"text-lg font-bold "+(y.totals_match?"text-green-600":"text-red-600"),children:["R$ ",null==(r=y.difference)?void 0:r.toFixed(2)]})]})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-4 text-sm",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block font-medium text-gray-700 mb-1",children:"Quantidade de Itens (Total)"}),u.jsx("div",{className:"text-lg font-bold text-gray-800",children:y.items_count})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block font-medium text-gray-700 mb-1",children:"Quantidade de Modelos (Linhas)"}),u.jsx("div",{className:"text-lg font-bold text-gray-800",children:y.models_count})]})]}),!y.totals_match&&u.jsxs("div",{className:"mt-4 p-3 bg-red-100 border border-red-300 rounded-lg",children:[u.jsx("p",{className:"text-red-800 font-medium",children:"⚠️ Atenção: Os valores não conferem! Verifique se:"}),u.jsxs("ul",{className:"text-red-700 text-sm mt-2 list-disc list-inside",children:[u.jsx("li",{children:"Todos os itens foram extraídos corretamente"}),u.jsx("li",{children:"Não há descontos ou taxas não capturadas"}),u.jsx("li",{children:"Os cálculos no PDF estão corretos"})]})]})]}),u.jsxs("div",{className:"border-t pt-4",children:[u.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-3",children:"Configurações"}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Logística"}),u.jsx("input",{type:"text",value:m.logistics,readOnly:!0,className:"w-full p-2 border border-gray-300 rounded-lg bg-gray-50"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Embalagem"}),u.jsx("input",{type:"text",value:m.packageType,readOnly:!0,className:"w-full p-2 border border-gray-300 rounded-lg bg-gray-50"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Observações"}),u.jsx("input",{type:"text",value:m.observations||"Nenhuma observação",readOnly:!0,className:"w-full p-2 border border-gray-300 rounded-lg bg-gray-50"})]})]})]})]}),u.jsxs("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:[u.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:["📦 Itens do Pedido (",v.items?v.items.length:0,")"]}),v.items&&v.items.length>0?u.jsx("div",{className:"overflow-x-auto",children:u.jsxs("table",{className:"w-full border-collapse",children:[u.jsx("thead",{children:u.jsxs("tr",{className:"border-b",children:[u.jsx("th",{className:"text-left p-2 font-medium text-gray-700",children:"Código"}),u.jsx("th",{className:"text-left p-2 font-medium text-gray-700",children:"Nome"}),u.jsx("th",{className:"text-left p-2 font-medium text-gray-700",children:"Quantidade"}),u.jsx("th",{className:"text-left p-2 font-medium text-gray-700",children:"Valor Unit."}),u.jsx("th",{className:"text-left p-2 font-medium text-gray-700",children:"Total"})]})}),u.jsx("tbody",{children:v.items.map((e,t)=>u.jsxs("tr",{className:t%2==0?"bg-gray-50":"bg-white",children:[u.jsx("td",{className:"p-2 text-sm",children:e.product_code||""}),u.jsx("td",{className:"p-2 text-sm",children:e.product_name||""}),u.jsx("td",{className:"p-2 text-sm",children:e.quantity||""}),u.jsx("td",{className:"p-2 text-sm",children:e.unit_price?`R$ ${e.unit_price.toFixed(2)}`:""}),u.jsx("td",{className:"p-2 text-sm",children:e.total_price?`R$ ${e.total_price.toFixed(2)}`:""})]},t))})]})}):u.jsx("p",{className:"text-gray-500 text-center py-4",children:"Nenhum item encontrado no PDF"})]}),u.jsxs("div",{className:"flex justify-between",children:[u.jsx("button",{onClick:()=>c(1),className:"px-6 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Voltar"}),u.jsx("button",{onClick:()=>{var e;(!y||y.totals_match||window.confirm(`ATENÇÃO: Há uma divergência de R$ ${null==(e=y.difference)?void 0:e.toFixed(2)} entre o valor calculado e o valor do PDF.\n\nDeseja prosseguir mesmo assim?\n\n⚠️ Alguns itens podem não ser separados corretamente!`))&&c(3)},className:"px-6 py-3 rounded-lg transition-colors "+(y&&!y.totals_match?"bg-red-600 hover:bg-red-700 text-white border-2 border-red-800":"bg-orange-600 hover:bg-orange-700 text-white"),children:y&&!y.totals_match?u.jsx("span",{className:"flex items-center",children:"⚠️ Confirmar com Divergência"}):"Próximo: Confirmar"})]})]}),3===o&&v&&u.jsxs("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:[u.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-6",children:"✅ Confirmação do Pedido"}),u.jsxs("div",{className:"mb-6 p-4 bg-orange-50 border border-orange-200 rounded-lg",children:[u.jsx("h3",{className:"font-semibold text-orange-800 mb-2",children:"Resumo Final"}),u.jsxs("div",{className:"text-sm text-orange-700 space-y-1",children:[u.jsxs("p",{children:[u.jsx("strong",{children:"Orçamento:"})," #",v.order_number]}),u.jsxs("p",{children:[u.jsx("strong",{children:"Cliente:"})," ",v.client_name]}),u.jsxs("p",{children:[u.jsx("strong",{children:"Vendedor:"})," ",v.seller_name]}),u.jsxs("p",{children:[u.jsx("strong",{children:"Itens:"})," ",v.items?v.items.length:0," produtos"]}),u.jsxs("p",{children:[u.jsx("strong",{children:"Valor Total:"})," R$ ",v.total_value]}),u.jsxs("p",{children:[u.jsx("strong",{children:"Logística:"})," ",m.logistics]}),u.jsxs("p",{children:[u.jsx("strong",{children:"Embalagem:"})," ",m.packageType]}),m.observations&&u.jsxs("p",{children:[u.jsx("strong",{children:"Observações:"})," ",m.observations]})]})]}),u.jsx("div",{className:"mb-6 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:u.jsxs("div",{className:"flex items-start",children:[u.jsx("svg",{className:"w-5 h-5 text-blue-500 mt-0.5 mr-3 flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20",children:u.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})}),u.jsxs("div",{className:"text-sm text-blue-700",children:[u.jsx("p",{className:"font-medium mb-1",children:"Antes de confirmar:"}),u.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[u.jsx("li",{children:"Verifique se todos os dados estão corretos"}),u.jsx("li",{children:"Confirme se todos os itens foram extraídos do PDF"}),u.jsx("li",{children:"Após a criação, o pedido estará disponível para separação"})]})]})]})}),u.jsxs("div",{className:"flex justify-between",children:[u.jsx("button",{onClick:()=>c(2),disabled:w,className:"px-6 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors disabled:opacity-50",children:"Voltar"}),u.jsx("button",{onClick:()=>x(this,null,function*(){var e,t;if(v){k(!0);try{const e={pdf_data:v,logistics_type:m.logistics,package_type:m.packageType,observations:m.observations||""},t=yield be.post("/orders/confirm",e);Ce("newOrder",0,{orderId:t.data.id,orderNumber:t.data.order_number}),n("Pedido criado com sucesso!","success"),a("/")}catch(s){let r="Erro ao criar pedido";if(null==(t=null==(e=s.response)?void 0:e.data)?void 0:t.detail){const e=s.response.data.detail;"string"==typeof e?r=e:Array.isArray(e)&&e.length>0?r=e.map(e=>e.msg||e.message||"Erro de validação").join(", "):"object"==typeof e&&e.msg&&(r=e.msg)}else s.message&&(r=s.message);n(r,"error")}finally{k(!1)}}else n("Dados do pedido não encontrados","error")}),disabled:w,className:"px-6 py-3 rounded-lg font-medium transition-colors flex items-center\n                    "+(w?"bg-gray-400 text-gray-200 cursor-not-allowed":"bg-green-600 text-white hover:bg-green-700"),children:w?u.jsxs(u.Fragment,{children:[u.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[u.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),u.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Criando Pedido..."]}):"✅ Criar Pedido"})]})]})]})})]})}function Oe({item:e,index:t,onUpdate:s,disabled:r=!1}){const[a,n]=b.useState(!1),[i,o]=b.useState(!1),l=e.sent_to_purchase?{bg:"bg-blue-50",textColor:""}:e.separated?{bg:"bg-green-50",textColor:""}:e.not_sent?{bg:"bg-red-50 border-l-4 border-red-500",textColor:"text-red-700"}:{bg:t%2==0?"bg-white":"bg-gray-50",textColor:""},d=e.sent_to_purchase?{badge:"Em Compras",badgeColor:"bg-blue-100 text-blue-800",icon:u.jsx(q,{className:"h-4 w-4"}),iconColor:"text-blue-500"}:e.separated?{badge:"Separado",badgeColor:"bg-green-100 text-green-800",icon:u.jsx(T,{className:"h-4 w-4"}),iconColor:"text-green-500"}:e.not_sent?{badge:"Não Enviado",badgeColor:"bg-red-600 text-white border border-red-700",icon:u.jsx(Q,{className:"h-4 w-4"}),iconColor:"text-red-600"}:{badge:"Pendente",badgeColor:"bg-gray-100 text-gray-800",icon:u.jsx(z,{className:"h-4 w-4"}),iconColor:"text-gray-400"};return u.jsxs("div",{className:`${l.bg} px-6 py-4 hover:bg-orange-50 transition-colors relative`,onMouseLeave:()=>n(!1),children:[u.jsxs("div",{className:"flex items-center space-x-4",children:[u.jsx("div",{className:"flex-shrink-0",children:u.jsx("button",{onClick:()=>x(this,null,function*(){if(!r&&!i){o(!0);try{!e.separated&&e.sent_to_purchase?yield s({separated:!0,sent_to_purchase:!1}):yield s({separated:!e.separated})}catch(t){}finally{o(!1)}}}),disabled:r||i||e.not_sent,className:`\n              w-6 h-6 rounded-md border-2 flex items-center justify-center transition-all\n              ${e.separated?"bg-green-500 border-green-500 text-white":e.not_sent?"bg-red-600 border-red-600 text-white":"border-gray-300 hover:border-orange-400"}\n              ${r||i||e.sent_to_purchase||e.not_sent?"opacity-50 cursor-not-allowed":"cursor-pointer"}\n            `,title:e.sent_to_purchase?"Item em compras":e.not_sent?"Item enviado (não enviado = enviado para fins de contagem)":e.separated?"Desmarcar como separado":"Marcar como separado",children:i?u.jsx("div",{className:"animate-spin rounded-full h-3 w-3 border border-current border-t-transparent"}):e.separated||e.not_sent?u.jsx(T,{className:"h-4 w-4"}):null})}),u.jsxs("div",{className:"flex-1 min-w-0 grid grid-cols-1 md:grid-cols-3 gap-4",children:[u.jsx("div",{className:"md:col-span-1",children:u.jsx("p",{className:`text-sm font-medium truncate ${l.textColor||"text-gray-900"}`,title:e.product_code,children:e.product_code})}),u.jsx("div",{className:"md:col-span-1",children:u.jsx("p",{className:`text-sm font-medium ${l.textColor||"text-gray-900"}`,title:e.product_name,children:e.product_name})}),u.jsx("div",{className:"md:col-span-1",children:u.jsxs("p",{className:`text-sm ${l.textColor||"text-gray-900"}`,children:[u.jsx("span",{className:"font-medium",children:e.quantity}),u.jsx("span",{className:"ml-1 "+(l.textColor?"text-red-500":"text-gray-500"),children:"UN"})]})})]}),u.jsxs("div",{className:"flex-shrink-0 flex items-center space-x-3",children:[u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx("div",{className:d.iconColor,children:d.icon}),u.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${d.badgeColor}`,children:d.badge})]}),u.jsxs("div",{className:"relative",children:[u.jsx("button",{onClick:()=>n(!a),disabled:r||i,className:`\n                p-1 text-gray-400 hover:text-gray-600 transition-colors\n                ${r||i?"opacity-50 cursor-not-allowed":"cursor-pointer"}\n              `,title:"Mais ações",children:u.jsx(F,{className:"h-5 w-5"})}),a&&u.jsx("div",{className:"absolute right-0 top-8 mt-1 w-56 bg-white rounded-md shadow-lg border border-gray-200 z-10",children:u.jsxs("div",{className:"py-1",children:[!e.sent_to_purchase&&!e.not_sent&&u.jsxs(u.Fragment,{children:[u.jsxs("button",{onClick:()=>x(this,null,function*(){if(!r&&!i){o(!0),n(!1);try{yield s({sent_to_purchase:!0})}catch(e){}finally{o(!1)}}}),className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 flex items-center space-x-2",children:[u.jsx(q,{className:"h-4 w-4"}),u.jsx("span",{children:"Enviar para compras"})]}),u.jsxs("button",{onClick:()=>x(this,null,function*(){if(!r&&!i){o(!0),n(!1);try{yield s({not_sent:!0})}catch(e){}finally{o(!1)}}}),className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 flex items-center space-x-2",children:[u.jsx(Q,{className:"h-4 w-4"}),u.jsx("span",{children:"Marcar como não enviado"})]})]}),e.sent_to_purchase&&u.jsxs("button",{onClick:()=>x(this,null,function*(){if(!r&&!i){o(!0),n(!1);try{yield s({sent_to_purchase:!1})}catch(e){}finally{o(!1)}}}),className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 flex items-center space-x-2",children:[u.jsx(Q,{className:"h-4 w-4"}),u.jsx("span",{children:"Remover das compras"})]}),e.not_sent&&u.jsxs("button",{onClick:()=>s({not_sent:!1}),className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 flex items-center space-x-2",children:[u.jsx(z,{className:"h-4 w-4"}),u.jsx("span",{children:"Marcar como pendente"})]})]})})]})]})]}),e.separated_at&&u.jsxs("div",{className:"mt-2 ml-10 text-xs text-gray-500",children:[u.jsx(z,{className:"inline h-3 w-3 mr-1"}),"Separado em ",(c=e.separated_at,c?new Intl.DateTimeFormat("pt-BR",{day:"2-digit",month:"2-digit",hour:"2-digit",minute:"2-digit"}).format(new Date(c)):null)]})]});var c}function Ee({progress:e=0,totalItems:t=0,separatedItems:s=0,animated:r=!0}){const[a,n]=b.useState(0);b.useEffect(()=>{if(!r)return void n(e);const t=(e-a)/30;if(Math.abs(t)<.1)return void n(e);const s=setInterval(()=>{n(r=>{const a=r+t;return Math.abs(a-e)<Math.abs(t)?(clearInterval(s),e):a})},500/30);return()=>clearInterval(s)},[e,r]);const i=a>=100,o=t-s;return u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsx("div",{className:"flex items-center space-x-6",children:u.jsxs("div",{className:"flex items-center space-x-2",children:[i?u.jsx(T,{className:"h-6 w-6 text-green-500"}):u.jsx(z,{className:"h-6 w-6 text-orange-500"}),u.jsxs("span",{className:"text-2xl font-bold "+(a>=100?"text-green-600":a>=75?"text-orange-500":a>=50?"text-orange-600":"text-red-600"),children:[Math.round(a),"%"]}),u.jsx("span",{className:"text-sm text-gray-500",children:"concluído"})]})}),u.jsxs("div",{className:"flex items-center space-x-6 text-sm",children:[u.jsxs("div",{className:"text-center",children:[u.jsx("div",{className:"font-semibold text-gray-900",children:s}),u.jsx("div",{className:"text-gray-500",children:"Separados"})]}),u.jsxs("div",{className:"text-center",children:[u.jsx("div",{className:"font-semibold text-gray-900",children:o}),u.jsx("div",{className:"text-gray-500",children:"Pendentes"})]}),u.jsxs("div",{className:"text-center",children:[u.jsx("div",{className:"font-semibold text-gray-900",children:t}),u.jsx("div",{className:"text-gray-500",children:"Total"})]})]})]}),u.jsxs("div",{className:"relative",children:[u.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3 overflow-hidden",children:u.jsx("div",{className:"h-full transition-all duration-500 ease-out "+(a>=100?"bg-green-500":a>=75?"bg-orange-400":a>=50?"bg-orange-500":"bg-red-500"),style:{width:`${Math.min(a,100)}%`}})}),u.jsx("div",{className:"absolute top-0 left-0 w-full h-3 flex items-center justify-between px-1",children:[25,50,75].map(e=>u.jsx("div",{className:"w-0.5 h-2 transition-colors duration-300 "+(a>=e?"bg-white opacity-60":"bg-gray-400 opacity-40"),style:{marginLeft:e-.25+"%"}},e))})]}),u.jsx("div",{className:"text-center",children:i?u.jsxs("div",{className:"flex items-center justify-center space-x-2 text-green-600",children:[u.jsx(T,{className:"h-5 w-5"}),u.jsx("span",{className:"font-medium",children:"Pedido concluído! 🎉"})]}):a>=75?u.jsx("p",{className:"text-orange-600 font-medium",children:"Quase lá! Faltam poucos itens 💪"}):a>=50?u.jsx("p",{className:"text-orange-600 font-medium",children:"Ótimo progresso! Continue assim 👍"}):a>0?u.jsx("p",{className:"text-gray-600 font-medium",children:"Separação em andamento... 🚀"}):u.jsx("p",{className:"text-gray-500",children:"Clique nos itens para marcar como separados"})})]})}function Le(){const{orderId:e}=v(),t=j(),{orderAccessUser:s,currentOrderId:r,hasOrderAccess:a,clearOrderAccess:n}=i(),{order:o,items:c,loading:m,error:h,updating:g,wsConnected:p,updateItem:f,completeOrder:y}=function(e){const[t,s]=b.useState(null),[r,a]=b.useState([]),[n,o]=b.useState(!0),[c,m]=b.useState(null),[u,h]=b.useState(!1),[g,p]=b.useState(!1),{addToast:j,showSuccess:v,showError:f}=O(),y=b.useRef(null),N=b.useRef(null),w=b.useRef(0),k=b.useCallback(()=>x(this,null,function*(){if(e)try{o(!0),m(null);const n=localStorage.getItem("auth_token"),i=yield fetch(`/api/v1/orders/${e}/detail`,{headers:{Authorization:`Bearer ${n}`,"Content-Type":"application/json"}});if(!i.ok){let e="";try{const s=yield i.text();try{const t=JSON.parse(s);e=t.detail||t.message||s}catch(t){e=s}}catch(r){e=`Erro ${i.status}: ${i.statusText}`}if(404===i.status)throw new Error("Pedido não encontrado");if(401===i.status)throw new Error("Acesso negado - verifique se você está logado");if(500===i.status)throw new Error(`Erro interno do servidor: ${e}`);throw new Error(`Erro ao carregar pedido (${i.status}): ${e}`)}const l=yield i.json();s(l);const d=[...l.items].sort((e,t)=>{const s=e=>e.separated?4:e.sent_to_purchase?3:e.not_sent?2:1,r=s(e),a=s(t);return r!==a?r-a:e.product_name.localeCompare(t.product_name,"pt-BR",{sensitivity:"base"})});a(d)}catch(n){const e="TypeError"===n.name&&n.message.includes("Failed to fetch")?"Erro de conexão - verifique se o servidor está rodando":n.message;m(e),f(e)}finally{o(!1)}}),[e,f]),C=b.useCallback((t,r,n=0)=>x(this,null,function*(){if(e&&!u)try{h(!0),i.getState().user;const n=localStorage.getItem("auth_token"),c={updates:[l({item_id:t},r)]},m=yield fetch(`/api/v1/orders/${e}/items`,{method:"PATCH",headers:{Authorization:`Bearer ${n}`,"Content-Type":"application/json"},body:JSON.stringify(c)});if(!m.ok){let e="";try{const t=yield m.text();try{const s=JSON.parse(t);e=s.detail||s.message||t}catch(o){e=t}}catch(d){e=`Erro ${m.status}: ${m.statusText}`}throw 404===m.status?new Error("Item ou pedido não encontrado"):401===m.status?new Error("Acesso negado - faça login novamente"):500===m.status?new Error("Erro interno do servidor - tente novamente"):new Error(`Erro ao atualizar item (${m.status}): ${e}`)}const x=yield m.json();s(x);const u=[...x.items].sort((e,t)=>{const s=e=>e.separated?4:e.sent_to_purchase?3:e.not_sent?2:1,r=s(e),a=s(t);return r!==a?r-a:e.product_name.localeCompare(t.product_name,"pt-BR",{sensitivity:"base"})});a(u),void 0!==r.separated&&v(r.separated?"Item marcado como separado":"Item desmarcado"),void 0!==r.sent_to_purchase&&v(r.sent_to_purchase?"Item enviado para compras":"Item removido das compras"),void 0!==r.not_sent&&v(r.not_sent?"Item marcado como não enviado":"Item marcado como pendente")}catch(c){const e="TypeError"===c.name&&c.message.includes("Failed to fetch");if(e&&n<2)return h(!1),yield new Promise(e=>setTimeout(e,1e3*(n+1))),C(t,r,n+1);const s=e?"Erro de conexão ao atualizar item - verifique se o servidor está rodando":`Erro ao atualizar item: ${c.message}`;f(s),yield k()}finally{h(!1)}}),[e,u,f,k]),_=b.useCallback(()=>{if(!e)return;const t=localStorage.getItem("auth_token"),s=`${"https:"===window.location.protocol?"wss:":"ws:"}//${"localhost"===window.location.hostname?"localhost:8000":window.location.host}/api/v1/ws/orders?token=${t}`;try{y.current=new WebSocket(s),y.current.onopen=()=>{p(!0),w.current>0&&v("Conexão reestabelecida!"),w.current=0,y.current.send(JSON.stringify({type:"join_order",data:{order_id:parseInt(e)}}))},y.current.onmessage=e=>{try{const t=JSON.parse(e.data);S(t)}catch(t){}},y.current.onclose=e=>{switch(p(!1),e.code){case 1e3:default:break;case 1006:f("Conexão perdida - tentando reconectar...");break;case 1008:f("Erro de autenticação - faça login novamente");break;case 1011:f("Erro no servidor - tentando reconectar...")}if(1e3!==e.code&&1008!==e.code&&w.current<5){const e=Math.min(1e3*Math.pow(2,w.current),3e4);N.current=setTimeout(()=>{w.current++,_()},e)}else w.current>=5&&f("Não foi possível reconectar - recarregue a página")},y.current.onerror=e=>{p(!1),e.type}}catch(r){p(!1)}},[e]),S=b.useCallback(t=>{if(!t.type||!t.data)return;const{type:r,data:n}=t;switch(r){case"item_separated":n.order_id===parseInt(e)&&(a(e=>e.map(e=>e.id===n.item_id?d(l({},e),{separated:!0,separated_at:(new Date).toISOString()}):e).sort((e,t)=>e.separated!==t.separated?e.separated?1:-1:e.product_name.localeCompare(t.product_name,"pt-BR",{sensitivity:"base"}))),s(e=>e?d(l({},e),{progress_percentage:n.progress_percentage||e.progress_percentage}):null));break;case"item_sent_to_purchase":n.order_id===parseInt(e)&&a(e=>e.map(e=>e.id===n.item_id?d(l({},e),{sent_to_purchase:!0}):e).sort((e,t)=>e.separated!==t.separated?e.separated?1:-1:e.product_name.localeCompare(t.product_name,"pt-BR",{sensitivity:"base"})));break;case"item_not_sent":n.order_id===parseInt(e)&&(a(e=>e.map(e=>e.id===n.item_id?d(l({},e),{not_sent:!0}):e).sort((e,t)=>{const s=e=>e.separated?4:e.sent_to_purchase?3:e.not_sent?2:1,r=s(e),a=s(t);return r!==a?r-a:e.product_name.localeCompare(t.product_name,"pt-BR",{sensitivity:"base"})})),s(e=>e?d(l({},e),{progress_percentage:n.progress_percentage||e.progress_percentage}):null));break;case"order_updated":n.order_id===parseInt(e)&&s(e=>e?d(l({},e),{progress_percentage:n.progress_percentage||e.progress_percentage}):null);break;case"order_completed":n.order_id===parseInt(e)&&(v("🎉 Pedido concluído!"),s(e=>e?d(l({},e),{progress_percentage:100,status:"completed"}):null))}},[e,v]),E=b.useCallback(()=>{y.current&&y.current.readyState===WebSocket.OPEN&&(y.current.send(JSON.stringify({type:"leave_order",data:{order_id:parseInt(e)}})),y.current.close(1e3,"Component unmounting"),y.current=null),N.current&&(clearTimeout(N.current),N.current=null)},[e]);b.useEffect(()=>{k()},[k]),b.useEffect(()=>(_(),E),[_,E]),b.useEffect(()=>E,[E]);const L=b.useCallback(()=>x(this,null,function*(){if(t)try{h(!0);const e=localStorage.getItem("auth_token");if(!e)throw new Error("Token de autenticação não encontrado");const r=yield fetch(`/api/v1/orders/${t.id}/complete`,{method:"POST",headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"}});if(!r.ok){const e=yield r.json().catch(()=>({})),t=e.detail||e.message||"Erro desconhecido";throw 404===r.status?new Error("Pedido não encontrado"):400===r.status?new Error(t):403===r.status?new Error("Sem permissão para completar pedidos"):401===r.status?new Error("Acesso negado - faça login novamente"):new Error(`Erro ao completar pedido (${r.status}): ${t}`)}const a=yield r.json();return s(e=>d(l({},e),{status:"completed",progress_percentage:100,completed_at:a.completed_at})),v("🎉 Pedido concluído com sucesso!"),a}catch(e){throw f(e.message||"Erro ao completar pedido"),e}finally{h(!1)}}),[t,v,f]);return{order:t,items:r,loading:n,error:c,updating:u,wsConnected:g,updateItem:C,completeOrder:L,refetch:k}}(e),N=a(parseInt(e)),w=s,k=()=>{n(),t("/")};if(!m&&!N)return u.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-4",children:u.jsxs("div",{className:"text-center max-w-md",children:[u.jsx("div",{className:"w-20 h-20 bg-orange-100 rounded-full flex items-center justify-center mx-auto mb-4",children:u.jsx("span",{className:"text-orange-500 text-2xl",children:"🔒"})}),u.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:"Acesso Negado"}),u.jsx("p",{className:"text-gray-600 mb-4",children:"Você precisa autenticar para acessar este pedido."}),u.jsx("button",{onClick:()=>t("/"),className:"w-full bg-orange-500 hover:bg-orange-600 text-white px-4 py-2 rounded-lg transition-colors",children:"Voltar ao Dashboard"})]})});const C=()=>!(!o||!c)&&("completed"!==o.status&&(c.filter(e=>e.separated).length+c.filter(e=>e.not_sent).length===o.items_count||o.progress_percentage>=100));if(m)return u.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:u.jsxs("div",{className:"text-center",children:[u.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-orange-500 mx-auto mb-4"}),u.jsx("p",{className:"text-gray-600",children:"Carregando pedido..."}),u.jsx("p",{className:"text-sm text-gray-500 mt-2",children:p?"Conectado ao servidor":"Conectando com o servidor..."})]})});if(h){const e=h.includes("Failed to fetch")||h.includes("500"),t=h.includes("404")||h.includes("não encontrado");return u.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-4",children:u.jsxs("div",{className:"text-center max-w-md",children:[u.jsx("div",{className:"w-20 h-20 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:u.jsx("span",{className:"text-red-500 text-2xl",children:"⚠️"})}),u.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:t?"Pedido não encontrado":"Erro ao carregar pedido"}),u.jsx("p",{className:"text-gray-600 mb-4",children:h}),e&&u.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3 mb-4",children:u.jsx("p",{className:"text-sm text-yellow-800",children:"Verifique se o servidor está rodando e tente novamente."})}),u.jsxs("div",{className:"space-y-2",children:[u.jsx("button",{onClick:()=>window.location.reload(),className:"w-full bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg transition-colors",children:"Tentar Novamente"}),u.jsx("button",{onClick:k,className:"w-full bg-orange-500 hover:bg-orange-600 text-white px-4 py-2 rounded-lg transition-colors",children:"Voltar ao Dashboard"})]})]})})}return o?u.jsxs("div",{className:"min-h-screen bg-gray-50",children:[u.jsx("div",{className:"bg-white shadow-sm border-b",children:u.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:u.jsxs("div",{className:"flex items-center justify-between h-16",children:[u.jsxs("div",{className:"flex items-center space-x-4",children:[u.jsx("button",{onClick:k,className:"p-2 text-gray-400 hover:text-gray-600 transition-colors",title:"Voltar ao Dashboard",children:u.jsx($,{className:"h-5 w-5"})}),u.jsxs("h1",{className:"text-xl font-semibold text-gray-900",children:["Separação - Orçamento #",o.order_number]}),w&&u.jsxs("div",{className:"flex items-center space-x-2 bg-orange-50 px-3 py-1 rounded-full",children:[u.jsx(ue,{user:w,size:"xs",showTooltip:!1}),u.jsx("span",{className:"text-sm font-medium text-orange-800",children:w.name})]})]}),u.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-500",children:[u.jsxs("div",{className:"flex items-center space-x-1",children:[u.jsx("div",{className:"h-2 w-2 rounded-full "+(p?"bg-green-500":"bg-red-500")}),u.jsx("span",{children:p?"Conectado":"Desconectado"})]}),u.jsxs("div",{className:"flex items-center",children:[u.jsx(z,{className:"inline h-4 w-4 mr-1"}),(S=o.created_at,new Intl.DateTimeFormat("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}).format(new Date(S)))]})]})]})})}),u.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[u.jsxs("div",{className:"bg-white rounded-lg shadow-sm border p-6 mb-6",children:[u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[u.jsxs("div",{className:"flex items-start space-x-3",children:[u.jsx(Z,{className:"h-5 w-5 text-gray-400 mt-0.5"}),u.jsxs("div",{children:[u.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Cliente"}),u.jsx("p",{className:"text-lg font-semibold text-gray-900",children:o.client_name})]})]}),u.jsxs("div",{className:"flex items-start space-x-3",children:[u.jsx(Z,{className:"h-5 w-5 text-gray-400 mt-0.5"}),u.jsxs("div",{children:[u.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Vendedor"}),u.jsx("p",{className:"text-lg font-semibold text-gray-900",children:o.seller_name})]})]}),u.jsxs("div",{className:"flex items-start space-x-3",children:[u.jsx(U,{className:"h-5 w-5 text-gray-400 mt-0.5"}),u.jsxs("div",{children:[u.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Valor Total"}),u.jsx("p",{className:"text-lg font-semibold text-gray-900",children:(_=o.total_value,new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(_))})]})]})]}),u.jsxs("div",{className:"mt-6",children:[u.jsx(Ee,{progress:o.progress_percentage,totalItems:o.items_count,separatedItems:c.filter(e=>e.separated).length}),C()&&u.jsx("div",{className:"mt-4 flex justify-center",children:u.jsx("button",{onClick:()=>x(this,null,function*(){if(C()&&window.confirm("Tem certeza que deseja finalizar este pedido?\n\nEsta ação marcará o pedido como concluído."))try{yield y(),setTimeout(()=>{t("/")},2e3)}catch(e){}}),disabled:g,className:"bg-green-600 hover:bg-green-700 disabled:bg-gray-400 text-white px-6 py-2 rounded-lg font-medium transition-colors duration-200 flex items-center gap-2",children:g?u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Finalizando..."]}):u.jsxs(u.Fragment,{children:[u.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Finalizar Pedido"]})})})]}),(o.logistics_type||o.package_type||o.observations)&&u.jsx("div",{className:"mt-6 pt-6 border-t border-gray-200",children:u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[o.logistics_type&&u.jsxs("div",{children:[u.jsx("span",{className:"font-medium text-gray-500",children:"Logística:"})," ",u.jsx("span",{className:"text-gray-900",children:o.logistics_type})]}),o.package_type&&u.jsxs("div",{children:[u.jsx("span",{className:"font-medium text-gray-500",children:"Embalagem:"})," ",u.jsx("span",{className:"text-gray-900",children:o.package_type})]}),o.observations&&u.jsxs("div",{className:"md:col-span-3",children:[u.jsx("span",{className:"font-medium text-gray-500",children:"Observações:"})," ",u.jsx("span",{className:"text-gray-900",children:o.observations})]})]})})]}),u.jsxs("div",{className:"bg-white rounded-lg shadow-sm border",children:[u.jsxs("div",{className:"px-6 py-4 border-b border-gray-200",children:[u.jsxs("h2",{className:"text-lg font-semibold text-gray-900",children:["Itens do Pedido (",c.length,")"]}),u.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Clique nos itens para marcar como separados ou enviar para compras"})]}),u.jsx("div",{className:"divide-y divide-gray-200",children:c.map((e,t)=>u.jsx(Oe,{item:e,index:t,onUpdate:t=>f(e.id,t),disabled:g},e.id))}),0===c.length&&u.jsx("div",{className:"px-6 py-12 text-center",children:u.jsx("p",{className:"text-gray-500",children:"Nenhum item encontrado neste pedido"})})]})]})]}):u.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:u.jsxs("div",{className:"text-center",children:[u.jsx("p",{className:"text-gray-600",children:"Pedido não encontrado"}),u.jsx("button",{onClick:k,className:"mt-4 bg-orange-500 text-white px-4 py-2 rounded-lg hover:bg-orange-600 transition-colors",children:"Voltar ao Dashboard"})]})});var _,S}function Ie(){const[e,t]=b.useState([]),[s,r]=b.useState(!0),[a,n]=b.useState(null),[o,l]=b.useState("order"),{user:d}=i();b.useEffect(()=>{c()},[]);const c=()=>x(this,null,function*(){try{r(!0);const e=yield be.get("/orders/purchase-items");t(e.data),n(null)}catch(e){n("Erro ao carregar itens em compras")}finally{r(!1)}}),m="order"===o?e.reduce((e,t)=>{const s=t.order_number;return e[s]||(e[s]={order_number:t.order_number,client_name:t.client_name,order_id:t.order_id,items:[]}),e[s].items.push(t),e},{}):{all:{items:e}};return s?u.jsx("div",{className:"min-h-screen bg-gray-50 p-6",children:u.jsx("div",{className:"max-w-7xl mx-auto",children:u.jsxs("div",{className:"animate-pulse",children:[u.jsx("div",{className:"h-8 bg-gray-200 rounded w-48 mb-6"}),u.jsx("div",{className:"space-y-4",children:[...Array(5)].map((e,t)=>u.jsx("div",{className:"h-20 bg-white rounded-lg shadow"},t))})]})})}):a?u.jsx("div",{className:"min-h-screen bg-gray-50 p-6",children:u.jsx("div",{className:"max-w-7xl mx-auto",children:u.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[u.jsx("h3",{className:"text-red-800 font-medium",children:"Erro"}),u.jsx("p",{className:"text-red-600 mt-1",children:a}),u.jsx("button",{onClick:c,className:"mt-3 px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700",children:"Tentar novamente"})]})})}):u.jsx("div",{className:"min-h-screen bg-gray-50 p-6",children:u.jsxs("div",{className:"max-w-7xl mx-auto",children:[u.jsxs("div",{className:"flex items-center justify-between mb-6",children:[u.jsxs("div",{children:[u.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Itens em Compras"}),u.jsxs("p",{className:"text-gray-600 mt-1",children:[e.length," ",1===e.length?"item":"itens"," aguardando compra"]})]}),u.jsxs("div",{className:"flex items-center space-x-4",children:[u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Agrupar por:"}),u.jsxs("select",{value:o,onChange:e=>l(e.target.value),className:"block px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-orange-500",children:[u.jsx("option",{value:"order",children:"Pedido"}),u.jsx("option",{value:"none",children:"Sem agrupamento"})]})]}),u.jsx("button",{onClick:c,className:"px-4 py-2 bg-orange-600 text-white rounded-md hover:bg-orange-700 transition-colors",children:"Atualizar"})]})]}),0===e.length?u.jsxs("div",{className:"bg-white rounded-lg shadow p-8 text-center",children:[u.jsx("div",{className:"text-gray-400 text-6xl mb-4",children:"📦"}),u.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Nenhum item em compras"}),u.jsx("p",{className:"text-gray-600",children:"Todos os itens foram processados ou não há itens pendentes."})]}):u.jsx("div",{className:"space-y-6",children:Object.entries(m).map(([e,t])=>u.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:["order"===o&&u.jsx("div",{className:"bg-orange-50 px-6 py-4 border-b border-orange-100",children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Orçamento #",t.order_number]}),u.jsx("p",{className:"text-gray-600",children:t.client_name})]}),u.jsxs("div",{className:"text-sm text-gray-600",children:[t.items.length," ",1===t.items.length?"item":"itens"]})]})}),u.jsx("div",{className:"overflow-x-auto",children:u.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[u.jsx("thead",{className:"bg-gray-50",children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Produto"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Código"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Quantidade"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Solicitado em"}),"none"===o&&u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Pedido"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"})]})}),u.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:t.items.map((e,t)=>{return u.jsxs("tr",{className:t%2==0?"bg-white":"bg-gray-50",children:[u.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:u.jsx("div",{className:"text-sm font-medium text-gray-900",children:e.product_name})}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:e.product_code}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.quantity}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:(s=e.requested_at,new Date(s).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}))}),"none"===o&&u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:u.jsxs("div",{children:[u.jsxs("div",{className:"font-medium",children:["#",e.order_number]}),u.jsx("div",{className:"text-gray-500",children:e.client_name})]})}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:u.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-orange-100 text-orange-800",children:"Pendente"})})]},e.id);var s})})]})})]},e))})]})})}function $e({onSuccess:e,onCancel:t}){const[s,r]=b.useState(""),[a,n]=b.useState(!1),[i,o]=b.useState("");return u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:u.jsxs(h.div,{initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.95,opacity:0},className:"bg-white rounded-lg shadow-xl p-6 w-full max-w-md mx-4",children:[u.jsxs("div",{className:"text-center mb-6",children:[u.jsx("div",{className:"w-16 h-16 bg-orange-500 rounded-full flex items-center justify-center mx-auto mb-4",children:u.jsx("svg",{className:"w-8 h-8 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m0 0v2m0-2h2m-2 0H10m6-4h.01M8 11h.01M12 7h.01M8 15h.01M16 15h.01M21 12c0 4.97-4.03 9-9 9s-9-4.03-9-9 4.03-9 9-9 9 4.03 9 9z"})})}),u.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Acesso Administrativo"}),u.jsx("p",{className:"text-gray-600",children:"Digite a senha de administrador para continuar"})]}),u.jsxs("form",{onSubmit:t=>x(this,null,function*(){t.preventDefault(),n(!0),o(""),"thmpv321"===s?setTimeout(()=>{n(!1),e()},1e3):setTimeout(()=>{n(!1),o("Senha incorreta"),r("")},1e3)}),className:"space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-2",children:"Senha do Administrador"}),u.jsx("input",{type:"password",id:"password",value:s,onChange:e=>r(e.target.value),className:`\n                w-full px-4 py-3 border rounded-lg text-center text-lg font-mono\n                focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-orange-500\n                ${i?"border-red-300 bg-red-50":"border-gray-300"}\n              `,placeholder:"Digite a senha",autoFocus:!0,disabled:a}),i&&u.jsx(h.p,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"text-red-600 text-sm mt-2 text-center",children:i})]}),u.jsxs("div",{className:"flex space-x-3",children:[u.jsx("button",{type:"button",onClick:t,className:"flex-1 px-4 py-3 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors",disabled:a,children:"Cancelar"}),u.jsx("button",{type:"submit",disabled:!s||a,className:`\n                flex-1 px-4 py-3 rounded-lg text-white font-medium transition-colors\n                ${s&&!a?"bg-orange-600 hover:bg-orange-700":"bg-gray-300 cursor-not-allowed"}\n              `,children:a?u.jsxs("div",{className:"flex items-center justify-center",children:[u.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}),"Verificando..."]}):"Acessar"})]})]})]})})}function Pe(){const[e,t]=b.useState([]),[s,r]=b.useState(!0),[a,n]=b.useState(!1),[i,o]=b.useState(null),[c,m]=b.useState({name:"",pin:"",role:"separator"}),{showSuccess:g,showError:p}=O();b.useEffect(()=>{j()},[]);const j=()=>x(this,null,function*(){try{r(!0);const e=yield be.get("/users");t(e.data)}catch(e){p("Erro ao carregar usuários")}finally{r(!1)}}),v=e=>x(this,null,function*(){var t,s;if(confirm(`Tem certeza que deseja remover o usuário ${e.name}?`))try{yield be.delete(`/users/${e.id}`),g("Usuário removido com sucesso"),j()}catch(r){p((null==(s=null==(t=r.response)?void 0:t.data)?void 0:s.detail)||"Erro ao remover usuário")}}),f=e=>({admin:"Administrador",seller:"Vendedor",separator:"Separador",buyer:"Comprador"}[e]||e);return u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Gerenciamento de Usuários"}),u.jsx("button",{onClick:()=>n(!0),className:"px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700 transition-colors",children:"Novo Usuário"})]}),a&&u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:u.jsxs(h.div,{initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},className:"bg-white rounded-lg shadow-xl p-6 w-full max-w-md mx-4",children:[u.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:i?"Editar Usuário":"Novo Usuário"}),u.jsxs("form",{onSubmit:e=>x(this,null,function*(){var t,s;e.preventDefault();try{i?(yield be.put(`/users/${i.id}`,c),g("Usuário atualizado com sucesso")):(yield be.post("/users",c),g("Usuário criado com sucesso")),m({name:"",pin:"",role:"separator"}),o(null),n(!1),j()}catch(r){p((null==(s=null==(t=r.response)?void 0:t.data)?void 0:s.detail)||"Erro ao salvar usuário")}}),className:"space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nome"}),u.jsx("input",{type:"text",value:c.name,onChange:e=>m(d(l({},c),{name:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-orange-500",required:!0})]}),u.jsxs("div",{children:[u.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["PIN ",i&&"(deixe vazio para manter atual)"]}),u.jsx("input",{type:"text",value:c.pin,onChange:e=>m(d(l({},c),{pin:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-orange-500",maxLength:"6",required:!i})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Função"}),u.jsxs("select",{value:c.role,onChange:e=>m(d(l({},c),{role:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-orange-500",children:[u.jsx("option",{value:"separator",children:"Separador"}),u.jsx("option",{value:"seller",children:"Vendedor"}),u.jsx("option",{value:"buyer",children:"Comprador"}),u.jsx("option",{value:"admin",children:"Administrador"})]})]}),u.jsxs("div",{className:"flex space-x-3 pt-4",children:[u.jsx("button",{type:"button",onClick:()=>{m({name:"",pin:"",role:"separator"}),o(null),n(!1)},className:"flex-1 px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50",children:"Cancelar"}),u.jsx("button",{type:"submit",className:"flex-1 px-4 py-2 bg-orange-600 text-white rounded-md hover:bg-orange-700",children:i?"Atualizar":"Criar"})]})]})]})}),u.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:s?u.jsx("div",{className:"p-8 text-center",children:u.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-orange-600 mx-auto"})}):u.jsx("div",{className:"overflow-x-auto",children:u.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[u.jsx("thead",{className:"bg-gray-50",children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Nome"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Função"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Criado em"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Ações"})]})}),u.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map((e,t)=>{return u.jsxs("tr",{className:t%2==0?"bg-white":"bg-gray-50",children:[u.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:u.jsx("div",{className:"text-sm font-medium text-gray-900",children:e.name})}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:u.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${s=e.role,{admin:"bg-red-100 text-red-800",seller:"bg-blue-100 text-blue-800",separator:"bg-green-100 text-green-800",buyer:"bg-yellow-100 text-yellow-800"}[s]||"bg-gray-100 text-gray-800"}`,children:f(e.role)})}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(e.created_at).toLocaleDateString("pt-BR")}),u.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium space-x-2",children:[u.jsx("button",{onClick:()=>(e=>{o(e),m({name:e.name,pin:"",role:e.role}),n(!0)})(e),className:"text-orange-600 hover:text-orange-900",children:"Editar"}),u.jsx("button",{onClick:()=>v(e),className:"text-red-600 hover:text-red-900",children:"Remover"})]})]},e.id);var s})})]})})})]})}function Me(){const[e,t]=b.useState(!1),[s,r]=b.useState(!0),[a,n]=b.useState(null),[i,o]=b.useState(!1),[l,d]=b.useState("dashboard"),c=j(),{showSuccess:m,showError:g}=O();b.useEffect(()=>{e&&p()},[e]);const p=()=>x(this,null,function*(){try{o(!0);const e=yield be.get("/orders/stats");n(e.data)}catch(e){g("Erro ao carregar estatísticas")}finally{o(!1)}}),v=()=>{t(!0),r(!1),m("Acesso administrativo autorizado")},f=()=>{c("/")},y=({title:e,value:t,subtitle:s,icon:r,color:a="orange"})=>u.jsx(h.div,{initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},whileHover:{scale:1.02},className:"bg-white rounded-lg shadow-md p-6 border border-gray-200",children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsx("h3",{className:"text-sm font-medium text-gray-600 mb-2",children:e}),u.jsx("p",{className:`text-3xl font-bold text-${a}-600`,children:null!=t?t:"--"}),s&&u.jsx("p",{className:"text-sm text-gray-500 mt-1",children:s})]}),u.jsx("div",{className:`w-12 h-12 bg-${a}-100 rounded-lg flex items-center justify-center`,children:r})]})});return s?u.jsx($e,{onSuccess:v,onCancel:f}):u.jsx("div",{className:"min-h-screen bg-gray-50 p-6",children:u.jsxs("div",{className:"max-w-7xl mx-auto",children:[u.jsxs(h.div,{initial:{y:-20,opacity:0},animate:{y:0,opacity:1},className:"flex items-center justify-between mb-8",children:[u.jsxs("div",{children:[u.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Painel Administrativo"}),u.jsx("p",{className:"text-gray-600 mt-1",children:"Relatórios, estatísticas e gerenciamento do sistema"})]}),u.jsx("button",{onClick:()=>c("/"),className:"px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors",children:"Voltar ao Dashboard"})]}),u.jsxs("div",{className:"flex space-x-1 bg-gray-100 p-1 rounded-lg mb-6",children:[u.jsx("button",{onClick:()=>d("dashboard"),className:"flex-1 px-4 py-2 rounded-md text-sm font-medium transition-colors "+("dashboard"===l?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"),children:"Dashboard"}),u.jsx("button",{onClick:()=>d("users"),className:"flex-1 px-4 py-2 rounded-md text-sm font-medium transition-colors "+("users"===l?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"),children:"Usuários"})]}),"users"===l?u.jsx(Pe,{}):i?u.jsx("div",{className:"flex items-center justify-center py-12",children:u.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-orange-600"})}):u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[u.jsx(y,{title:"Total de Pedidos",value:null==a?void 0:a.total_orders,icon:u.jsx("svg",{className:"w-6 h-6 text-orange-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14-7H5a2 2 0 00-2 2v14a2 2 0 002 2h14a2 2 0 002-2V5a2 2 0 00-2-2z"})})}),u.jsx(y,{title:"Em Andamento",value:null==a?void 0:a.orders_in_progress,subtitle:`${(null==a?void 0:a.orders_pending)||0} pendentes`,color:"blue",icon:u.jsx("svg",{className:"w-6 h-6 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}),u.jsx(y,{title:"Concluídos",value:null==a?void 0:a.orders_completed,color:"green",icon:u.jsx("svg",{className:"w-6 h-6 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),u.jsx(y,{title:"Tempo Médio",value:(null==a?void 0:a.average_separation_time)?`${a.average_separation_time.toFixed(1)}h`:"--",subtitle:"de separação",color:"purple",icon:u.jsx("svg",{className:"w-6 h-6 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})})]}),u.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 mb-8",children:[u.jsx(y,{title:"Total de Itens",value:null==a?void 0:a.total_items,icon:u.jsx("svg",{className:"w-6 h-6 text-orange-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"})})}),u.jsx(y,{title:"Itens Separados",value:null==a?void 0:a.items_separated,subtitle:(null==a?void 0:a.total_items)?`${(a.items_separated/a.total_items*100).toFixed(1)}% do total`:"",color:"green",icon:u.jsx("svg",{className:"w-6 h-6 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),u.jsx(y,{title:"Em Compras",value:null==a?void 0:a.items_in_purchase,color:"yellow",icon:u.jsx("svg",{className:"w-6 h-6 text-yellow-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"})})})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[u.jsx(h.div,{whileHover:{scale:1.02},className:"bg-white rounded-lg shadow-md p-6 border border-gray-200 cursor-pointer",onClick:()=>d("users"),children:u.jsxs("div",{className:"flex items-center space-x-4",children:[u.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center",children:u.jsx("svg",{className:"w-6 h-6 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-4.5a2.25 2.25 0 11-4.5 0 2.25 2.25 0 014.5 0z"})})}),u.jsxs("div",{children:[u.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Gerenciar Usuários"}),u.jsx("p",{className:"text-gray-600 text-sm",children:"Criar, editar e remover usuários"})]})]})}),u.jsx(h.div,{whileHover:{scale:1.02},className:"bg-white rounded-lg shadow-md p-6 border border-gray-200 cursor-pointer",onClick:()=>g("Funcionalidade em desenvolvimento"),children:u.jsxs("div",{className:"flex items-center space-x-4",children:[u.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center",children:u.jsx("svg",{className:"w-6 h-6 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),u.jsxs("div",{children:[u.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Relatórios"}),u.jsx("p",{className:"text-gray-600 text-sm",children:"Gráficos e análises detalhadas"})]})]})}),u.jsx(h.div,{whileHover:{scale:1.02},className:"bg-white rounded-lg shadow-md p-6 border border-gray-200 cursor-pointer",onClick:()=>c("/purchase-items"),children:u.jsxs("div",{className:"flex items-center space-x-4",children:[u.jsx("div",{className:"w-12 h-12 bg-orange-100 rounded-lg flex items-center justify-center",children:u.jsx("svg",{className:"w-6 h-6 text-orange-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"})})}),u.jsxs("div",{children:[u.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Tela de Compras"}),u.jsx("p",{className:"text-gray-600 text-sm",children:"Gerenciar itens em compras"})]})]})})]})]})]})})}function Ae({children:e,requireRole:t=null}){const{isAuthenticated:s,user:r}=i();return s?t&&(null==r?void 0:r.role)!==t?u.jsx(f,{to:"/",replace:!0}):e:u.jsx(f,{to:"/login",replace:!0})}function Te(){const{isAuthenticated:e}=i();return Ce("app",0,{isAuthenticated:e,renderCount:_e("appRender")}),u.jsx(ee,{children:u.jsx(E,{children:u.jsx(y,{basename:"/separacao_pmcell-2025",children:u.jsx("div",{className:"min-h-screen bg-gray-50 safe-top safe-bottom",children:u.jsxs(N,{children:[u.jsx(w,{path:"/login",element:e?u.jsx(f,{to:"/",replace:!0}):u.jsx(te,{children:u.jsx(ce,{})})}),u.jsx(w,{path:"/",element:u.jsx(Ae,{children:u.jsx(te,{children:u.jsx(we,{})})})}),u.jsx(w,{path:"/novo-pedido",element:u.jsx(Ae,{children:u.jsx(te,{children:u.jsx(Se,{})})})}),u.jsx(w,{path:"/orders/:orderId/separation",element:u.jsx(Ae,{children:u.jsx(te,{children:u.jsx(Le,{})})})}),u.jsx(w,{path:"/purchase-items",element:u.jsx(Ae,{children:u.jsx(te,{children:u.jsx(Ie,{})})})}),u.jsx(w,{path:"/admin",element:u.jsx(Ae,{children:u.jsx(te,{children:u.jsx(Me,{})})})}),u.jsx(w,{path:"*",element:u.jsx(f,{to:"/",replace:!0})})]})})})})})}"undefined"!=typeof window&&(window.debugCounters={appRender:0,dashboardRender:0,useOrdersCall:0,useOrdersEffect:0,authStoreChange:0,toastProviderRender:0,apiRequest:0}),t(document.getElementById("root")).render(u.jsx(Te,{}))}},function(){return S||(0,_[r(_)[0]])((S={exports:{}}).exports,S),S.exports});export default O();
